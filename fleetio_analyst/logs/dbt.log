

============================== 2022-05-13 21:01:07.736413 | dad27cbf-9e00-451a-b61e-4fede1ab0ccc ==============================
21:01:07.736422 [info ] [MainThread]: Running with dbt=1.1.0
21:01:07.736785 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
21:01:07.737005 [debug] [MainThread]: Tracking: tracking
21:01:07.759477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7143d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b714130>]}
21:01:07.761095 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/madisonflagg/.dbt
21:01:07.761451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7143d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b714130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b715210>]}


============================== 2022-05-13 21:04:59.133908 | 720679ce-e668-489f-aeb5-0f9a333282ff ==============================
21:04:59.133933 [info ] [MainThread]: Running with dbt=1.1.0
21:04:59.134516 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
21:04:59.134755 [debug] [MainThread]: Tracking: tracking
21:04:59.153327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d56c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7220>]}
21:04:59.168406 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:04:59.168735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c9d80>]}
21:04:59.198718 [debug] [MainThread]: Parsing macros/catalog.sql
21:04:59.202525 [debug] [MainThread]: Parsing macros/relations.sql
21:04:59.203976 [debug] [MainThread]: Parsing macros/adapters.sql
21:04:59.229184 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
21:04:59.231060 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:04:59.235764 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:04:59.238539 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:04:59.240216 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:04:59.259379 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:04:59.273405 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:04:59.285075 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:04:59.289621 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:04:59.291345 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:04:59.293093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:04:59.297652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:04:59.315003 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:04:59.316455 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:04:59.327017 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:04:59.343219 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:04:59.351133 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:04:59.354196 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:04:59.361722 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:04:59.363039 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:04:59.365839 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:04:59.368105 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:04:59.374381 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:04:59.391690 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:04:59.393244 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:04:59.395684 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:04:59.397270 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:04:59.398137 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:04:59.399058 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:04:59.399784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:04:59.401116 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:04:59.405651 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:04:59.414247 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:04:59.416529 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:04:59.419242 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:04:59.429384 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:04:59.432237 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:04:59.436734 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:04:59.444297 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:04:59.454432 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:04:59.680912 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
21:04:59.693479 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
21:04:59.756913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec1810>]}
21:04:59.762243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ce440>]}
21:04:59.762555 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:04:59.762791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087acbb0>]}
21:04:59.764218 [info ] [MainThread]: 
21:04:59.764666 [debug] [MainThread]: Acquiring new postgres connection "master"
21:04:59.765552 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
21:04:59.774514 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
21:04:59.774706 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
21:04:59.774851 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:04:59.810212 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.04 seconds
21:04:59.812200 [debug] [ThreadPool]: On list_madisonflagg: Close
21:04:59.813850 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
21:04:59.820027 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:04:59.820201 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
21:04:59.820329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:04:59.824893 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
21:04:59.825070 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:04:59.825217 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
21:04:59.830427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
21:04:59.831844 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
21:04:59.832148 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
21:04:59.836432 [debug] [MainThread]: Using postgres connection "master"
21:04:59.836608 [debug] [MainThread]: On master: BEGIN
21:04:59.836731 [debug] [MainThread]: Opening a new connection, currently in state init
21:04:59.841485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:04:59.841669 [debug] [MainThread]: Using postgres connection "master"
21:04:59.841804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:04:59.847325 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
21:04:59.849029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f435b0>]}
21:04:59.849371 [debug] [MainThread]: On master: ROLLBACK
21:04:59.849722 [debug] [MainThread]: Using postgres connection "master"
21:04:59.849883 [debug] [MainThread]: On master: BEGIN
21:04:59.850287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:04:59.850447 [debug] [MainThread]: On master: COMMIT
21:04:59.850589 [debug] [MainThread]: Using postgres connection "master"
21:04:59.850715 [debug] [MainThread]: On master: COMMIT
21:04:59.850961 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:04:59.851130 [debug] [MainThread]: On master: Close
21:04:59.851480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:04:59.851734 [info ] [MainThread]: 
21:04:59.855950 [debug] [Thread-1 (]: Began running node seed.fleetio_analyst.accounts
21:04:59.856422 [info ] [Thread-1 (]: 1 of 4 START seed file fleetio_analyst.accounts ................................ [RUN]
21:04:59.856864 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.fleetio_analyst.accounts"
21:04:59.857051 [debug] [Thread-1 (]: Began compiling node seed.fleetio_analyst.accounts
21:04:59.857230 [debug] [Thread-1 (]: finished collecting timing info
21:04:59.857374 [debug] [Thread-1 (]: Began executing node seed.fleetio_analyst.accounts
21:04:59.896123 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.accounts"
21:04:59.896368 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: BEGIN
21:04:59.896504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:04:59.901260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
21:04:59.901417 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.accounts"
21:04:59.901535 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "seed.fleetio_analyst.accounts"} */

    create table "madisonflagg"."fleetio_analyst"."accounts" ("id" text,"company" text,"primary_contact_id" text,"country" text,"state" text,"city" text,"industry" text,"fleet_size" text)
  
21:04:59.913451 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
21:05:00.630531 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.accounts"
21:05:00.630811 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: 
          insert into "madisonflagg"."fleetio_analyst"."accounts" ("id", "company", "primary_contact_id", "country", "state", "city", "industry", "fleet_size") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,...
21:05:00.646372 [debug] [Thread-1 (]: SQL status: INSERT 0 461 in 0.02 seconds
21:05:00.652013 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.fleetio_analyst.accounts"
21:05:00.664027 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: COMMIT
21:05:00.666879 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.accounts"
21:05:00.667134 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: COMMIT
21:05:00.669487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:05:00.670210 [debug] [Thread-1 (]: finished collecting timing info
21:05:00.670429 [debug] [Thread-1 (]: On seed.fleetio_analyst.accounts: Close
21:05:00.670854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0dc30>]}
21:05:00.671153 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file fleetio_analyst.accounts ............................ [[32mINSERT 461[0m in 0.81s]
21:05:00.671565 [debug] [Thread-1 (]: Finished running node seed.fleetio_analyst.accounts
21:05:00.671776 [debug] [Thread-1 (]: Began running node seed.fleetio_analyst.contacts
21:05:00.672125 [info ] [Thread-1 (]: 2 of 4 START seed file fleetio_analyst.contacts ................................ [RUN]
21:05:00.672531 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.fleetio_analyst.contacts"
21:05:00.672675 [debug] [Thread-1 (]: Began compiling node seed.fleetio_analyst.contacts
21:05:00.672812 [debug] [Thread-1 (]: finished collecting timing info
21:05:00.672942 [debug] [Thread-1 (]: Began executing node seed.fleetio_analyst.contacts
21:05:00.695364 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.contacts"
21:05:00.695544 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: BEGIN
21:05:00.695661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:05:00.701483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:05:00.701785 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.contacts"
21:05:00.701953 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "seed.fleetio_analyst.contacts"} */

    create table "madisonflagg"."fleetio_analyst"."contacts" ("id" text,"first_name" text,"last_name" text,"job_title" text,"email" text,"account_id" text,"lead_id" text,"created_at" timestamp without time zone)
  
21:05:00.705487 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
21:05:01.461830 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.contacts"
21:05:01.462255 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: 
          insert into "madisonflagg"."fleetio_analyst"."contacts" ("id", "first_name", "last_name", "job_title", "email", "account_id", "lead_id", "created_at") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s...
21:05:01.474182 [debug] [Thread-1 (]: SQL status: INSERT 0 461 in 0.01 seconds
21:05:01.474691 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.fleetio_analyst.contacts"
21:05:01.476694 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: COMMIT
21:05:01.476898 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.contacts"
21:05:01.477149 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: COMMIT
21:05:01.477951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:05:01.478493 [debug] [Thread-1 (]: finished collecting timing info
21:05:01.478695 [debug] [Thread-1 (]: On seed.fleetio_analyst.contacts: Close
21:05:01.479208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0c760>]}
21:05:01.479492 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file fleetio_analyst.contacts ............................ [[32mINSERT 461[0m in 0.81s]
21:05:01.479947 [debug] [Thread-1 (]: Finished running node seed.fleetio_analyst.contacts
21:05:01.480234 [debug] [Thread-1 (]: Began running node seed.fleetio_analyst.leads
21:05:01.480615 [info ] [Thread-1 (]: 3 of 4 START seed file fleetio_analyst.leads ................................... [RUN]
21:05:01.481015 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.fleetio_analyst.leads"
21:05:01.481156 [debug] [Thread-1 (]: Began compiling node seed.fleetio_analyst.leads
21:05:01.481289 [debug] [Thread-1 (]: finished collecting timing info
21:05:01.481423 [debug] [Thread-1 (]: Began executing node seed.fleetio_analyst.leads
21:05:01.541863 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.leads"
21:05:01.542140 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: BEGIN
21:05:01.542339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:05:01.549200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:05:01.549519 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.leads"
21:05:01.549749 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "seed.fleetio_analyst.leads"} */

    create table "madisonflagg"."fleetio_analyst"."leads" ("id" text,"first_name" text,"last_name" text,"job_title" text,"email" text,"company" text,"created_at" timestamp without time zone,"converted_at" timestamp without time zone,"source" text,"country" text,"city" text,"state" text,"industry" text,"fleet_size" text)
  
21:05:01.553169 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
21:05:04.262488 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.leads"
21:05:04.262850 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: 
          insert into "madisonflagg"."fleetio_analyst"."leads" ("id", "first_name", "last_name", "job_title", "email", "company", "created_at", "converted_at", "source", "country", "city", "state", "industry", "fleet_size") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s...
21:05:04.294575 [debug] [Thread-1 (]: SQL status: INSERT 0 946 in 0.03 seconds
21:05:04.295344 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.fleetio_analyst.leads"
21:05:04.297512 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: COMMIT
21:05:04.297713 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.leads"
21:05:04.297846 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: COMMIT
21:05:04.298748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:05:04.299286 [debug] [Thread-1 (]: finished collecting timing info
21:05:04.299463 [debug] [Thread-1 (]: On seed.fleetio_analyst.leads: Close
21:05:04.299866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed0190>]}
21:05:04.300133 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file fleetio_analyst.leads ............................... [[32mINSERT 946[0m in 2.82s]
21:05:04.300493 [debug] [Thread-1 (]: Finished running node seed.fleetio_analyst.leads
21:05:04.300674 [debug] [Thread-1 (]: Began running node seed.fleetio_analyst.opportunities
21:05:04.300982 [info ] [Thread-1 (]: 4 of 4 START seed file fleetio_analyst.opportunities ........................... [RUN]
21:05:04.301486 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.fleetio_analyst.opportunities"
21:05:04.301695 [debug] [Thread-1 (]: Began compiling node seed.fleetio_analyst.opportunities
21:05:04.301842 [debug] [Thread-1 (]: finished collecting timing info
21:05:04.301968 [debug] [Thread-1 (]: Began executing node seed.fleetio_analyst.opportunities
21:05:04.331945 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.opportunities"
21:05:04.332183 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: BEGIN
21:05:04.332309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:05:04.337916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:05:04.338264 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.opportunities"
21:05:04.338450 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "seed.fleetio_analyst.opportunities"} */

    create table "madisonflagg"."fleetio_analyst"."opportunities" ("id" text,"account_id" text,"created_at" timestamp without time zone,"closed_at" timestamp without time zone,"is_closed" boolean,"is_won" boolean,"country" text,"state" text,"city" text)
  
21:05:04.341688 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
21:05:05.130278 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.opportunities"
21:05:05.130541 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: 
          insert into "madisonflagg"."fleetio_analyst"."opportunities" ("id", "account_id", "created_at", "closed_at", "is_closed", "is_won", "country", "state", "city") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%...
21:05:05.144058 [debug] [Thread-1 (]: SQL status: INSERT 0 461 in 0.01 seconds
21:05:05.144623 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.fleetio_analyst.opportunities"
21:05:05.146618 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: COMMIT
21:05:05.146790 [debug] [Thread-1 (]: Using postgres connection "seed.fleetio_analyst.opportunities"
21:05:05.146932 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: COMMIT
21:05:05.147608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:05:05.148116 [debug] [Thread-1 (]: finished collecting timing info
21:05:05.148301 [debug] [Thread-1 (]: On seed.fleetio_analyst.opportunities: Close
21:05:05.148730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720679ce-e668-489f-aeb5-0f9a333282ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed0820>]}
21:05:05.148999 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file fleetio_analyst.opportunities ....................... [[32mINSERT 461[0m in 0.85s]
21:05:05.149371 [debug] [Thread-1 (]: Finished running node seed.fleetio_analyst.opportunities
21:05:05.150601 [debug] [MainThread]: Acquiring new postgres connection "master"
21:05:05.150793 [debug] [MainThread]: Using postgres connection "master"
21:05:05.150927 [debug] [MainThread]: On master: BEGIN
21:05:05.151052 [debug] [MainThread]: Opening a new connection, currently in state closed
21:05:05.156018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:05:05.156275 [debug] [MainThread]: On master: COMMIT
21:05:05.156414 [debug] [MainThread]: Using postgres connection "master"
21:05:05.156541 [debug] [MainThread]: On master: COMMIT
21:05:05.156789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:05:05.156966 [debug] [MainThread]: On master: Close
21:05:05.157342 [info ] [MainThread]: 
21:05:05.157580 [info ] [MainThread]: Finished running 4 seeds in 5.39s.
21:05:05.157792 [debug] [MainThread]: Connection 'master' was properly closed.
21:05:05.157914 [debug] [MainThread]: Connection 'seed.fleetio_analyst.opportunities' was properly closed.
21:05:05.162555 [info ] [MainThread]: 
21:05:05.162797 [info ] [MainThread]: [32mCompleted successfully[0m
21:05:05.163047 [info ] [MainThread]: 
21:05:05.163253 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
21:05:05.163514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b83a0>]}


============================== 2022-05-13 21:25:09.070791 | 6f77c1b4-c936-4073-8842-dd9c01a5b4fa ==============================
21:25:09.070825 [info ] [MainThread]: Running with dbt=1.1.0
21:25:09.071831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:25:09.072003 [debug] [MainThread]: Tracking: tracking
21:25:09.098991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7ce80>]}
21:25:09.122967 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
21:25:09.123385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f77c1b4-c936-4073-8842-dd9c01a5b4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c803790>]}
21:25:09.153143 [debug] [MainThread]: Parsing macros/catalog.sql
21:25:09.156936 [debug] [MainThread]: Parsing macros/relations.sql
21:25:09.158558 [debug] [MainThread]: Parsing macros/adapters.sql
21:25:09.188803 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
21:25:09.190921 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:25:09.196828 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:25:09.199561 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:25:09.201556 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:25:09.226365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:25:09.240653 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:25:09.252541 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:25:09.257339 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:25:09.259205 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:25:09.261081 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:25:09.265968 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:25:09.283915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:25:09.285520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:25:09.296628 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:25:09.313487 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:25:09.321686 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:25:09.324650 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:25:09.333196 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:25:09.334543 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:25:09.337305 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:25:09.339794 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:25:09.346824 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:25:09.395266 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:25:09.396990 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:25:09.399557 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:25:09.401166 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:25:09.402220 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:25:09.403116 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:25:09.403812 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:25:09.405248 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:25:09.410086 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:25:09.419589 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:25:09.421802 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:25:09.424609 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:25:09.435122 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:25:09.438248 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:25:09.442999 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:25:09.451074 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:25:09.461553 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:25:09.688714 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_leads' in the 'models' section of file 'models/staging/schema.yml'
21:25:09.698540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fleetio_analyst.staging
- models.fleetio_analyst.marts

21:25:09.703408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f77c1b4-c936-4073-8842-dd9c01a5b4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e4310>]}
21:25:09.710484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f77c1b4-c936-4073-8842-dd9c01a5b4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca79ea0>]}
21:25:09.710934 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:25:09.711469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f77c1b4-c936-4073-8842-dd9c01a5b4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ab820>]}
21:25:09.712791 [info ] [MainThread]: 
21:25:09.713114 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
21:25:09.729999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c801660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8031f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c801ba0>]}


============================== 2022-05-13 21:25:54.635306 | 73a520dd-b49e-459f-8b70-1881dacc0d91 ==============================
21:25:54.635333 [info ] [MainThread]: Running with dbt=1.1.0
21:25:54.635950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:25:54.636148 [debug] [MainThread]: Tracking: tracking
21:25:54.653738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120367d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112036ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112034e20>]}
21:25:54.690341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
21:25:54.690741 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/staging/stg_leads.sql
21:25:54.706271 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_leads.sql
21:25:54.722022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fleetio_analyst.marts

21:25:54.726985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73a520dd-b49e-459f-8b70-1881dacc0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d0340>]}
21:25:54.732401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73a520dd-b49e-459f-8b70-1881dacc0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276a650>]}
21:25:54.733043 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:25:54.733683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a520dd-b49e-459f-8b70-1881dacc0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbd840>]}
21:25:54.735482 [info ] [MainThread]: 
21:25:54.736449 [debug] [MainThread]: Acquiring new postgres connection "master"
21:25:54.737441 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
21:25:54.779267 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
21:25:54.779572 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
21:25:54.779760 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:25:54.809119 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
21:25:54.810785 [debug] [ThreadPool]: On list_madisonflagg: Close
21:25:54.812060 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
21:25:54.817951 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:25:54.818167 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
21:25:54.818318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:25:54.823618 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:25:54.823816 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:25:54.823957 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
21:25:54.827099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
21:25:54.828332 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
21:25:54.828614 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
21:25:54.832499 [debug] [MainThread]: Using postgres connection "master"
21:25:54.832665 [debug] [MainThread]: On master: BEGIN
21:25:54.832790 [debug] [MainThread]: Opening a new connection, currently in state init
21:25:54.837351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:25:54.837580 [debug] [MainThread]: Using postgres connection "master"
21:25:54.837707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:25:54.851464 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
21:25:54.852816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a520dd-b49e-459f-8b70-1881dacc0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f85c30>]}
21:25:54.853123 [debug] [MainThread]: On master: ROLLBACK
21:25:54.853390 [debug] [MainThread]: Using postgres connection "master"
21:25:54.853525 [debug] [MainThread]: On master: BEGIN
21:25:54.853896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:25:54.854044 [debug] [MainThread]: On master: COMMIT
21:25:54.854172 [debug] [MainThread]: Using postgres connection "master"
21:25:54.854286 [debug] [MainThread]: On master: COMMIT
21:25:54.854510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:25:54.854663 [debug] [MainThread]: On master: Close
21:25:54.855021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:25:54.855253 [info ] [MainThread]: 
21:25:54.858938 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
21:25:54.859267 [info ] [Thread-1 (]: 1 of 1 START view model fleetio_analyst.stg_leads .............................. [RUN]
21:25:54.859697 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
21:25:54.859846 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
21:25:54.859994 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
21:25:54.862167 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
21:25:54.862923 [debug] [Thread-1 (]: finished collecting timing info
21:25:54.863096 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
21:25:54.885314 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
21:25:54.886533 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:25:54.886766 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
21:25:54.886956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:25:54.892394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:25:54.892686 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:25:54.892862 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with leads as {

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

}

select * from leads
  );
21:25:54.893342 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 4:     with leads as {
                          ^

21:25:54.893517 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: ROLLBACK
21:25:54.893866 [debug] [Thread-1 (]: finished collecting timing info
21:25:54.894032 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
21:25:54.894366 [debug] [Thread-1 (]: Database Error in model stg_leads (models/staging/stg_leads.sql)
  syntax error at or near "{"
  LINE 4:     with leads as {
                            ^
  compiled SQL at target/run/fleetio_analyst/models/staging/stg_leads.sql
21:25:54.894639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a520dd-b49e-459f-8b70-1881dacc0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112779990>]}
21:25:54.894985 [error] [Thread-1 (]: 1 of 1 ERROR creating view model fleetio_analyst.stg_leads ..................... [[31mERROR[0m in 0.04s]
21:25:54.895442 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
21:25:54.896545 [debug] [MainThread]: Acquiring new postgres connection "master"
21:25:54.896723 [debug] [MainThread]: Using postgres connection "master"
21:25:54.896845 [debug] [MainThread]: On master: BEGIN
21:25:54.896959 [debug] [MainThread]: Opening a new connection, currently in state closed
21:25:54.901300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:25:54.901479 [debug] [MainThread]: On master: COMMIT
21:25:54.901604 [debug] [MainThread]: Using postgres connection "master"
21:25:54.901721 [debug] [MainThread]: On master: COMMIT
21:25:54.901934 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:25:54.902073 [debug] [MainThread]: On master: Close
21:25:54.902411 [info ] [MainThread]: 
21:25:54.902633 [info ] [MainThread]: Finished running 1 view model in 0.17s.
21:25:54.902914 [debug] [MainThread]: Connection 'master' was properly closed.
21:25:54.903062 [debug] [MainThread]: Connection 'model.fleetio_analyst.stg_leads' was properly closed.
21:25:54.907810 [info ] [MainThread]: 
21:25:54.908062 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:25:54.908291 [info ] [MainThread]: 
21:25:54.908486 [error] [MainThread]: [33mDatabase Error in model stg_leads (models/staging/stg_leads.sql)[0m
21:25:54.908735 [error] [MainThread]:   syntax error at or near "{"
21:25:54.908924 [error] [MainThread]:   LINE 4:     with leads as {
21:25:54.909103 [error] [MainThread]:                             ^
21:25:54.909277 [error] [MainThread]:   compiled SQL at target/run/fleetio_analyst/models/staging/stg_leads.sql
21:25:54.909460 [info ] [MainThread]: 
21:25:54.909646 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
21:25:54.909914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111798ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11179a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f84190>]}


============================== 2022-05-13 21:26:23.347827 | f3760ba9-cbfc-4831-84b8-eac08a201acd ==============================
21:26:23.347962 [info ] [MainThread]: Running with dbt=1.1.0
21:26:23.349292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:26:23.349604 [debug] [MainThread]: Tracking: tracking
21:26:23.368539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4db0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4daec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d8e20>]}
21:26:23.405896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:26:23.406346 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/staging/stg_leads.sql
21:26:23.418039 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_leads.sql
21:26:23.433260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fleetio_analyst.marts

21:26:23.439093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3760ba9-cbfc-4831-84b8-eac08a201acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac31420>]}
21:26:23.475914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3760ba9-cbfc-4831-84b8-eac08a201acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbe0b0>]}
21:26:23.476259 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:26:23.476761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3760ba9-cbfc-4831-84b8-eac08a201acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbe440>]}
21:26:23.478225 [info ] [MainThread]: 
21:26:23.478702 [debug] [MainThread]: Acquiring new postgres connection "master"
21:26:23.479339 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
21:26:23.488406 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
21:26:23.488576 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
21:26:23.488703 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:26:23.514230 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
21:26:23.515738 [debug] [ThreadPool]: On list_madisonflagg: Close
21:26:23.517047 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
21:26:23.523012 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:26:23.523206 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
21:26:23.523333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:26:23.528332 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
21:26:23.528524 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:26:23.528672 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
21:26:23.531618 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
21:26:23.532836 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
21:26:23.533120 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
21:26:23.537052 [debug] [MainThread]: Using postgres connection "master"
21:26:23.537222 [debug] [MainThread]: On master: BEGIN
21:26:23.537354 [debug] [MainThread]: Opening a new connection, currently in state init
21:26:23.541439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:26:23.541673 [debug] [MainThread]: Using postgres connection "master"
21:26:23.541807 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:26:23.553587 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
21:26:23.554988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3760ba9-cbfc-4831-84b8-eac08a201acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25ce80>]}
21:26:23.555273 [debug] [MainThread]: On master: ROLLBACK
21:26:23.555598 [debug] [MainThread]: Using postgres connection "master"
21:26:23.555728 [debug] [MainThread]: On master: BEGIN
21:26:23.556135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:26:23.556300 [debug] [MainThread]: On master: COMMIT
21:26:23.556441 [debug] [MainThread]: Using postgres connection "master"
21:26:23.556565 [debug] [MainThread]: On master: COMMIT
21:26:23.556924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:26:23.557116 [debug] [MainThread]: On master: Close
21:26:23.557494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:26:23.557797 [info ] [MainThread]: 
21:26:23.561428 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
21:26:23.561711 [info ] [Thread-1 (]: 1 of 1 START view model fleetio_analyst.stg_leads .............................. [RUN]
21:26:23.562125 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.562282 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
21:26:23.562437 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
21:26:23.564692 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
21:26:23.565168 [debug] [Thread-1 (]: finished collecting timing info
21:26:23.565323 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
21:26:23.587327 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
21:26:23.587991 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.588142 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
21:26:23.588261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:26:23.593479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:26:23.593741 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.593875 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with leads as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from leads
  );
21:26:23.600885 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
21:26:23.606936 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.607091 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
21:26:23.607567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:26:23.613940 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
21:26:23.614108 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.614227 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
21:26:23.614933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:26:23.619361 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:26:23.619511 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
21:26:23.620073 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
21:26:23.621191 [debug] [Thread-1 (]: finished collecting timing info
21:26:23.621401 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
21:26:23.621826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3760ba9-cbfc-4831-84b8-eac08a201acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac02a40>]}
21:26:23.622150 [info ] [Thread-1 (]: 1 of 1 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.06s]
21:26:23.622531 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
21:26:23.623681 [debug] [MainThread]: Acquiring new postgres connection "master"
21:26:23.623849 [debug] [MainThread]: Using postgres connection "master"
21:26:23.623971 [debug] [MainThread]: On master: BEGIN
21:26:23.624084 [debug] [MainThread]: Opening a new connection, currently in state closed
21:26:23.628929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:26:23.629194 [debug] [MainThread]: On master: COMMIT
21:26:23.629324 [debug] [MainThread]: Using postgres connection "master"
21:26:23.629445 [debug] [MainThread]: On master: COMMIT
21:26:23.629735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:26:23.629897 [debug] [MainThread]: On master: Close
21:26:23.630263 [info ] [MainThread]: 
21:26:23.630493 [info ] [MainThread]: Finished running 1 view model in 0.15s.
21:26:23.630697 [debug] [MainThread]: Connection 'master' was properly closed.
21:26:23.630814 [debug] [MainThread]: Connection 'model.fleetio_analyst.stg_leads' was properly closed.
21:26:23.635323 [info ] [MainThread]: 
21:26:23.635601 [info ] [MainThread]: [32mCompleted successfully[0m
21:26:23.635846 [info ] [MainThread]: 
21:26:23.636039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:26:23.636317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac305e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25d1e0>]}


============================== 2022-05-13 21:34:53.916517 | f78da248-3ac7-407b-9b2e-b6e7e2fe6d99 ==============================
21:34:53.916546 [info ] [MainThread]: Running with dbt=1.1.0
21:34:53.917542 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:34:53.917763 [debug] [MainThread]: Tracking: tracking
21:34:53.939858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce4e80>]}
21:34:53.991707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
21:34:53.992103 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/staging/stg_opportunities.sql
21:34:53.992300 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/staging/stg_contacts.sql
21:34:53.992480 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/staging/stg_accounts.sql
21:34:53.992772 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/staging/schema.yml
21:34:53.993077 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/staging/stg_leads.sql
21:34:54.009742 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_opportunities.sql
21:34:54.023698 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_contacts.sql
21:34:54.027085 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_accounts.sql
21:34:54.029759 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_leads.sql
21:34:54.076109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fleetio_analyst.marts

21:34:54.081279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cec190>]}
21:34:54.086929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113403f70>]}
21:34:54.087401 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
21:34:54.087700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113403fd0>]}
21:34:54.089230 [info ] [MainThread]: 
21:34:54.089735 [debug] [MainThread]: Acquiring new postgres connection "master"
21:34:54.090575 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
21:34:54.100471 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
21:34:54.100661 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
21:34:54.100788 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:34:54.130692 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
21:34:54.132406 [debug] [ThreadPool]: On list_madisonflagg: Close
21:34:54.133817 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
21:34:54.139759 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:34:54.140012 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
21:34:54.140291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:34:54.145782 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:34:54.146030 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
21:34:54.146172 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
21:34:54.149298 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
21:34:54.150637 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
21:34:54.150896 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
21:34:54.155417 [debug] [MainThread]: Using postgres connection "master"
21:34:54.155576 [debug] [MainThread]: On master: BEGIN
21:34:54.155699 [debug] [MainThread]: Opening a new connection, currently in state init
21:34:54.160098 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:34:54.160256 [debug] [MainThread]: Using postgres connection "master"
21:34:54.160377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:34:54.171804 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:34:54.173050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113403220>]}
21:34:54.173322 [debug] [MainThread]: On master: ROLLBACK
21:34:54.173590 [debug] [MainThread]: Using postgres connection "master"
21:34:54.173733 [debug] [MainThread]: On master: BEGIN
21:34:54.174085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:34:54.174244 [debug] [MainThread]: On master: COMMIT
21:34:54.174383 [debug] [MainThread]: Using postgres connection "master"
21:34:54.174505 [debug] [MainThread]: On master: COMMIT
21:34:54.174734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:34:54.174884 [debug] [MainThread]: On master: Close
21:34:54.175229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:34:54.175456 [info ] [MainThread]: 
21:34:54.179378 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
21:34:54.179711 [info ] [Thread-1 (]: 1 of 4 START view model fleetio_analyst.stg_accounts ........................... [RUN]
21:34:54.180132 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.180283 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
21:34:54.180423 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
21:34:54.182739 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
21:34:54.183243 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.183414 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
21:34:54.206158 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
21:34:54.206810 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.206943 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
21:34:54.207056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:34:54.212481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:34:54.212722 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.212855 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
21:34:54.215730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
21:34:54.221536 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.221705 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
21:34:54.222214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:34:54.228532 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
21:34:54.228703 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.228822 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
21:34:54.229411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:34:54.233878 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
21:34:54.234045 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
21:34:54.234433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
21:34:54.235636 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.235800 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
21:34:54.236207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134664a0>]}
21:34:54.236554 [info ] [Thread-1 (]: 1 of 4 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
21:34:54.236965 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
21:34:54.237175 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
21:34:54.237551 [info ] [Thread-1 (]: 2 of 4 START view model fleetio_analyst.stg_contacts ........................... [RUN]
21:34:54.237962 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.238101 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
21:34:54.238233 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
21:34:54.240655 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
21:34:54.241120 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.241285 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
21:34:54.243218 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
21:34:54.243627 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.243754 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
21:34:54.243865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:34:54.248966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:34:54.249261 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.249384 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
21:34:54.251845 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
21:34:54.254203 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.254347 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
21:34:54.254850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:34:54.255888 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
21:34:54.256042 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.256167 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
21:34:54.256681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:34:54.258200 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
21:34:54.258384 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
21:34:54.258784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
21:34:54.259887 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.260071 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
21:34:54.260544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc9720>]}
21:34:54.261018 [info ] [Thread-1 (]: 2 of 4 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.02s]
21:34:54.261424 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
21:34:54.261646 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
21:34:54.261974 [info ] [Thread-1 (]: 3 of 4 START view model fleetio_analyst.stg_leads .............................. [RUN]
21:34:54.262447 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.262623 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
21:34:54.262779 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
21:34:54.265169 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
21:34:54.265692 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.265864 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
21:34:54.268296 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
21:34:54.268847 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.269001 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
21:34:54.269127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:34:54.274866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
21:34:54.275141 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.275290 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
21:34:54.278649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
21:34:54.281223 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.281390 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
21:34:54.281955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:34:54.283718 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.283846 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
21:34:54.284269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:34:54.285343 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
21:34:54.285485 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.285609 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
21:34:54.286144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:34:54.287432 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
21:34:54.287596 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
21:34:54.290100 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
21:34:54.291509 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.291720 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
21:34:54.292149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ccb7c0>]}
21:34:54.292527 [info ] [Thread-1 (]: 3 of 4 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
21:34:54.292978 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
21:34:54.293278 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
21:34:54.293639 [info ] [Thread-1 (]: 4 of 4 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
21:34:54.294096 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.294250 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
21:34:54.294393 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
21:34:54.297382 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
21:34:54.297939 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.298185 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
21:34:54.301615 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
21:34:54.302200 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.302409 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
21:34:54.302572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:34:54.307396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
21:34:54.307581 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.307704 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
21:34:54.310153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
21:34:54.312197 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.312338 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
21:34:54.312803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
21:34:54.313979 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
21:34:54.314126 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.314251 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
21:34:54.314788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
21:34:54.316301 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
21:34:54.316435 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
21:34:54.316745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
21:34:54.317714 [debug] [Thread-1 (]: finished collecting timing info
21:34:54.317868 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
21:34:54.318251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f78da248-3ac7-407b-9b2e-b6e7e2fe6d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113535270>]}
21:34:54.318616 [info ] [Thread-1 (]: 4 of 4 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.02s]
21:34:54.318976 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
21:34:54.320146 [debug] [MainThread]: Acquiring new postgres connection "master"
21:34:54.320334 [debug] [MainThread]: Using postgres connection "master"
21:34:54.320465 [debug] [MainThread]: On master: BEGIN
21:34:54.320590 [debug] [MainThread]: Opening a new connection, currently in state closed
21:34:54.325500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:34:54.325957 [debug] [MainThread]: On master: COMMIT
21:34:54.326205 [debug] [MainThread]: Using postgres connection "master"
21:34:54.326384 [debug] [MainThread]: On master: COMMIT
21:34:54.326782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:34:54.327083 [debug] [MainThread]: On master: Close
21:34:54.327805 [info ] [MainThread]: 
21:34:54.328257 [info ] [MainThread]: Finished running 4 view models in 0.24s.
21:34:54.328629 [debug] [MainThread]: Connection 'master' was properly closed.
21:34:54.328835 [debug] [MainThread]: Connection 'model.fleetio_analyst.stg_opportunities' was properly closed.
21:34:54.334634 [info ] [MainThread]: 
21:34:54.334896 [info ] [MainThread]: [32mCompleted successfully[0m
21:34:54.335149 [info ] [MainThread]: 
21:34:54.335359 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
21:34:54.335679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113536b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113534610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135340a0>]}


============================== 2022-05-14 13:25:34.619952 | 379a3122-2d33-4075-8ccd-c418ef6061ae ==============================
13:25:34.619977 [info ] [MainThread]: Running with dbt=1.1.0
13:25:34.622551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:25:34.622735 [debug] [MainThread]: Tracking: tracking
13:25:34.651048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f131a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f132ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f130e80>]}
13:25:34.692941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
13:25:34.693332 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/marts/lead_time_grain.sql
13:25:34.693589 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/marts/schema.yml
13:25:34.694144 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/staging/schema.yml
13:25:34.705595 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_time_grain.sql
13:25:34.718447 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_contacts.sql
13:25:34.721300 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_accounts.sql
13:25:34.723800 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_opportunities.sql
13:25:34.795821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0df60>]}
13:25:34.801768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f13b0a0>]}
13:25:34.802071 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:25:34.802314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb8d390>]}
13:25:34.803718 [info ] [MainThread]: 
13:25:34.804150 [debug] [MainThread]: Acquiring new postgres connection "master"
13:25:34.805092 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:25:34.814181 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:25:34.814341 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:25:34.814464 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:25:34.864285 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
13:25:34.865860 [debug] [ThreadPool]: On list_madisonflagg: Close
13:25:34.867344 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:25:34.873078 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:25:34.873292 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:25:34.873422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:25:34.878721 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
13:25:34.878972 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:25:34.879106 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:25:34.886623 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
13:25:34.888104 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:25:34.888417 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:25:34.893427 [debug] [MainThread]: Using postgres connection "master"
13:25:34.893605 [debug] [MainThread]: On master: BEGIN
13:25:34.893723 [debug] [MainThread]: Opening a new connection, currently in state init
13:25:34.898391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:34.898606 [debug] [MainThread]: Using postgres connection "master"
13:25:34.898733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:25:34.917294 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
13:25:34.918710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1148e0>]}
13:25:34.919037 [debug] [MainThread]: On master: ROLLBACK
13:25:34.919330 [debug] [MainThread]: Using postgres connection "master"
13:25:34.919473 [debug] [MainThread]: On master: BEGIN
13:25:34.919863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:34.920024 [debug] [MainThread]: On master: COMMIT
13:25:34.920164 [debug] [MainThread]: Using postgres connection "master"
13:25:34.920295 [debug] [MainThread]: On master: COMMIT
13:25:34.920532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:25:34.920684 [debug] [MainThread]: On master: Close
13:25:34.921047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:25:34.921279 [info ] [MainThread]: 
13:25:34.924040 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:25:34.924309 [info ] [Thread-1 (]: 1 of 5 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:25:34.924710 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.924854 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:25:34.924999 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:25:34.927355 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:25:34.927883 [debug] [Thread-1 (]: finished collecting timing info
13:25:34.928046 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:25:34.949592 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:25:34.950249 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.950407 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:25:34.950587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:34.955328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:34.955594 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.955731 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:25:34.961085 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
13:25:34.967106 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.967257 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:25:34.967872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:34.969690 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.969822 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:25:34.970233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:34.977412 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:25:34.977685 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.977820 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:25:34.978539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:34.983169 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:34.983309 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:25:34.984713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:34.985895 [debug] [Thread-1 (]: finished collecting timing info
13:25:34.986078 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:25:34.986471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f87c8e0>]}
13:25:34.986827 [info ] [Thread-1 (]: 1 of 5 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:25:34.987270 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:25:34.987480 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:25:34.987791 [info ] [Thread-1 (]: 2 of 5 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:25:34.988166 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:25:34.988309 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:25:34.988446 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:25:34.990567 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:25:34.991025 [debug] [Thread-1 (]: finished collecting timing info
13:25:34.991188 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:25:34.993084 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:25:34.993515 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:34.993643 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:25:34.993757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:34.998236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:34.998464 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:34.998597 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:25:35.002114 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:35.004739 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:35.004893 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:25:35.005380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.007345 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:35.007478 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:25:35.007925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.008963 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:25:35.009101 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:35.009238 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:25:35.009773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:35.011010 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:35.011140 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:25:35.012119 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:35.014793 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.015015 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:25:35.015439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a48b0>]}
13:25:35.015815 [info ] [Thread-1 (]: 2 of 5 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
13:25:35.016265 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:25:35.016485 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:25:35.016833 [info ] [Thread-1 (]: 3 of 5 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:25:35.017244 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.017399 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:25:35.017546 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:25:35.019981 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:25:35.020492 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.020643 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:25:35.022845 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:25:35.023395 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.023538 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:25:35.023665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:35.028323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:35.028530 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.028652 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:25:35.031236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:35.033458 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.033597 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:25:35.034044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.035799 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.035942 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:25:35.036428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.037448 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:25:35.037582 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.037697 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:25:35.038291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:35.039587 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:35.039717 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:25:35.040843 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:35.042224 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.042462 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:25:35.043616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a4280>]}
13:25:35.044471 [info ] [Thread-1 (]: 3 of 5 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:25:35.045079 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:25:35.045272 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:25:35.045608 [info ] [Thread-1 (]: 4 of 5 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:25:35.046243 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.046387 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:25:35.046522 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:25:35.048936 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:25:35.049455 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.049617 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:25:35.051670 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:25:35.052133 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.052292 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:25:35.052411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:35.056952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:35.057117 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.057236 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:25:35.059957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:35.062106 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.062241 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:25:35.062692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.064366 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.064497 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:25:35.064987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:35.066075 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:25:35.066209 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.066324 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:25:35.066829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:35.068349 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:35.068500 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:25:35.069578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:35.070774 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.070964 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:25:35.071357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f867e80>]}
13:25:35.071701 [info ] [Thread-1 (]: 4 of 5 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:25:35.072111 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:25:35.072322 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_time_grain
13:25:35.072653 [info ] [Thread-1 (]: 5 of 5 START table model fleetio_analyst.lead_time_grain ....................... [RUN]
13:25:35.073039 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:35.073176 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_time_grain
13:25:35.073307 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_time_grain
13:25:35.075485 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_time_grain"
13:25:35.076029 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.076193 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_time_grain
13:25:35.098103 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_time_grain"
13:25:35.098830 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:35.098967 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: BEGIN
13:25:35.099091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:35.103785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:35.104013 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:35.104137 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp"
  as (
    select
    id as lead_id,
    converted_at::date as converted_at_day,
    datetrunc('week', converted_at) as converted_at_week,
    datetrunc('month', converted_at) as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  );
13:25:35.105942 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function datetrunc(unknown, timestamp without time zone) does not exist
LINE 9:     datetrunc('week', converted_at) as converted_at_week,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

13:25:35.106131 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: ROLLBACK
13:25:35.106477 [debug] [Thread-1 (]: finished collecting timing info
13:25:35.106641 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: Close
13:25:35.107003 [debug] [Thread-1 (]: Database Error in model lead_time_grain (models/marts/lead_time_grain.sql)
  function datetrunc(unknown, timestamp without time zone) does not exist
  LINE 9:     datetrunc('week', converted_at) as converted_at_week,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/fleetio_analyst/models/marts/lead_time_grain.sql
13:25:35.107257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379a3122-2d33-4075-8ccd-c418ef6061ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa1a2c0>]}
13:25:35.107684 [error] [Thread-1 (]: 5 of 5 ERROR creating table model fleetio_analyst.lead_time_grain .............. [[31mERROR[0m in 0.03s]
13:25:35.108127 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_time_grain
13:25:35.109274 [debug] [MainThread]: Acquiring new postgres connection "master"
13:25:35.109505 [debug] [MainThread]: Using postgres connection "master"
13:25:35.109637 [debug] [MainThread]: On master: BEGIN
13:25:35.109756 [debug] [MainThread]: Opening a new connection, currently in state closed
13:25:35.114297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:35.114543 [debug] [MainThread]: On master: COMMIT
13:25:35.114670 [debug] [MainThread]: Using postgres connection "master"
13:25:35.114789 [debug] [MainThread]: On master: COMMIT
13:25:35.115023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:25:35.115181 [debug] [MainThread]: On master: Close
13:25:35.115608 [info ] [MainThread]: 
13:25:35.115842 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0.31s.
13:25:35.116050 [debug] [MainThread]: Connection 'master' was properly closed.
13:25:35.116174 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_time_grain' was properly closed.
13:25:35.122807 [info ] [MainThread]: 
13:25:35.123058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:25:35.123295 [info ] [MainThread]: 
13:25:35.123500 [error] [MainThread]: [33mDatabase Error in model lead_time_grain (models/marts/lead_time_grain.sql)[0m
13:25:35.123701 [error] [MainThread]:   function datetrunc(unknown, timestamp without time zone) does not exist
13:25:35.123874 [error] [MainThread]:   LINE 9:     datetrunc('week', converted_at) as converted_at_week,
13:25:35.124042 [error] [MainThread]:               ^
13:25:35.124209 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
13:25:35.124377 [error] [MainThread]:   compiled SQL at target/run/fleetio_analyst/models/marts/lead_time_grain.sql
13:25:35.124561 [info ] [MainThread]: 
13:25:35.124741 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
13:25:35.125004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb8d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eebcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9dc070>]}


============================== 2022-05-14 13:25:54.941884 | 0d254f9d-0c08-45f3-98d8-1c017a217e07 ==============================
13:25:54.941912 [info ] [MainThread]: Running with dbt=1.1.0
13:25:54.942681 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:25:54.942913 [debug] [MainThread]: Tracking: tracking
13:25:54.961806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaaec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea8e80>]}
13:25:55.000876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:25:55.001375 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/marts/lead_time_grain.sql
13:25:55.012841 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_time_grain.sql
13:25:55.072750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eac190>]}
13:25:55.078267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cbfd0>]}
13:25:55.078651 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:25:55.078935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cba30>]}
13:25:55.080625 [info ] [MainThread]: 
13:25:55.081211 [debug] [MainThread]: Acquiring new postgres connection "master"
13:25:55.082123 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:25:55.092574 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:25:55.092790 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:25:55.092933 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:25:55.111176 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:25:55.112687 [debug] [ThreadPool]: On list_madisonflagg: Close
13:25:55.114604 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:25:55.120547 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:25:55.120739 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:25:55.120874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:25:55.125302 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:25:55.125483 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:25:55.125610 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:25:55.128653 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
13:25:55.129970 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:25:55.130256 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:25:55.134963 [debug] [MainThread]: Using postgres connection "master"
13:25:55.135159 [debug] [MainThread]: On master: BEGIN
13:25:55.135286 [debug] [MainThread]: Opening a new connection, currently in state init
13:25:55.140287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:55.140536 [debug] [MainThread]: Using postgres connection "master"
13:25:55.140689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:25:55.154913 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
13:25:55.156457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11160b2b0>]}
13:25:55.156784 [debug] [MainThread]: On master: ROLLBACK
13:25:55.157112 [debug] [MainThread]: Using postgres connection "master"
13:25:55.157267 [debug] [MainThread]: On master: BEGIN
13:25:55.157676 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:55.157877 [debug] [MainThread]: On master: COMMIT
13:25:55.158067 [debug] [MainThread]: Using postgres connection "master"
13:25:55.158221 [debug] [MainThread]: On master: COMMIT
13:25:55.158501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:25:55.158672 [debug] [MainThread]: On master: Close
13:25:55.159068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:25:55.159362 [info ] [MainThread]: 
13:25:55.162662 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:25:55.162963 [info ] [Thread-1 (]: 1 of 5 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:25:55.163381 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.163542 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:25:55.163705 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:25:55.166072 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:25:55.166585 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.166757 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:25:55.189808 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:25:55.190500 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.190657 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:25:55.190790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:55.195696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:55.195960 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.196098 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:25:55.199033 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:55.205119 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.205286 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:25:55.205733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.207587 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.207743 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:25:55.208265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.215697 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:25:55.216167 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.216408 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:25:55.217217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:55.222183 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:25:55.222343 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:25:55.223405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:55.224494 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.224662 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:25:55.225041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df5360>]}
13:25:55.225392 [info ] [Thread-1 (]: 1 of 5 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:25:55.225829 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:25:55.226034 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:25:55.226335 [info ] [Thread-1 (]: 2 of 5 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:25:55.226684 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.226827 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:25:55.226963 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:25:55.228996 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:25:55.229482 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.229639 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:25:55.231698 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:25:55.232117 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.232251 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:25:55.232373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:55.236968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:55.237226 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.237365 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:25:55.239764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:55.242061 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.242210 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:25:55.242727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.244598 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.244743 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:25:55.245170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.246226 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:25:55.246365 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.246488 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:25:55.247000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:55.248342 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:25:55.248488 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:25:55.249501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:55.250410 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.250572 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:25:55.250922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162f670>]}
13:25:55.251240 [info ] [Thread-1 (]: 2 of 5 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.02s]
13:25:55.251629 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:25:55.251811 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:25:55.252051 [info ] [Thread-1 (]: 3 of 5 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:25:55.252500 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.252647 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:25:55.252784 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:25:55.255118 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:25:55.255607 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.255765 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:25:55.258021 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:25:55.258544 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.258680 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:25:55.258798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:55.263976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
13:25:55.264237 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.264394 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:25:55.267284 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:55.269924 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.270145 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:25:55.270704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.273938 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.274085 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:25:55.274512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.275531 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:25:55.275670 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.275792 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:25:55.276303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:55.277521 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:25:55.277670 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:25:55.278737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:55.279935 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.280133 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:25:55.280531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112718c10>]}
13:25:55.281072 [info ] [Thread-1 (]: 3 of 5 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:25:55.282076 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:25:55.282610 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:25:55.283211 [info ] [Thread-1 (]: 4 of 5 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:25:55.283689 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.283837 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:25:55.283977 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:25:55.286310 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:25:55.286772 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.286942 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:25:55.288898 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:25:55.289378 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.289534 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:25:55.289666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:55.294661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:55.294848 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.294980 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:25:55.298611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:25:55.300718 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.300875 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:25:55.301387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.303246 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.303383 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:25:55.303776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.304757 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:25:55.304894 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.305013 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:25:55.305583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:55.306991 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:25:55.307139 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:25:55.308212 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:25:55.309141 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.309302 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:25:55.309693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112725300>]}
13:25:55.310025 [info ] [Thread-1 (]: 4 of 5 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:25:55.310423 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:25:55.310665 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_time_grain
13:25:55.311034 [info ] [Thread-1 (]: 5 of 5 START table model fleetio_analyst.lead_time_grain ....................... [RUN]
13:25:55.311570 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.311805 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_time_grain
13:25:55.311972 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_time_grain
13:25:55.314611 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_time_grain"
13:25:55.315348 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.315549 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_time_grain
13:25:55.337815 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_time_grain"
13:25:55.338374 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.338510 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: BEGIN
13:25:55.338634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:55.343373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:25:55.343603 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.343729 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp"
  as (
    select
    id as lead_id,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at) as converted_at_week,
    date_trunc('month', converted_at) as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  );
13:25:55.350580 [debug] [Thread-1 (]: SQL status: SELECT 946 in 0.01 seconds
13:25:55.352998 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.353162 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp" rename to "lead_time_grain"
13:25:55.353734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:25:55.358888 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:25:55.359052 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.359187 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:25:55.359948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:25:55.361377 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:25:55.361512 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_backup" cascade
13:25:55.361876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
13:25:55.363003 [debug] [Thread-1 (]: finished collecting timing info
13:25:55.363191 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: Close
13:25:55.363588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d254f9d-0c08-45f3-98d8-1c017a217e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112536950>]}
13:25:55.363900 [info ] [Thread-1 (]: 5 of 5 OK created table model fleetio_analyst.lead_time_grain .................. [[32mSELECT 946[0m in 0.05s]
13:25:55.364411 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_time_grain
13:25:55.365573 [debug] [MainThread]: Acquiring new postgres connection "master"
13:25:55.365756 [debug] [MainThread]: Using postgres connection "master"
13:25:55.365883 [debug] [MainThread]: On master: BEGIN
13:25:55.366002 [debug] [MainThread]: Opening a new connection, currently in state closed
13:25:55.370541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:25:55.370810 [debug] [MainThread]: On master: COMMIT
13:25:55.370954 [debug] [MainThread]: Using postgres connection "master"
13:25:55.371090 [debug] [MainThread]: On master: COMMIT
13:25:55.371394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:25:55.371593 [debug] [MainThread]: On master: Close
13:25:55.372020 [info ] [MainThread]: 
13:25:55.372259 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0.29s.
13:25:55.372486 [debug] [MainThread]: Connection 'master' was properly closed.
13:25:55.372628 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_time_grain' was properly closed.
13:25:55.378726 [info ] [MainThread]: 
13:25:55.378999 [info ] [MainThread]: [32mCompleted successfully[0m
13:25:55.379260 [info ] [MainThread]: 
13:25:55.379469 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:25:55.379776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df7040>]}


============================== 2022-05-14 13:27:10.046976 | d14a1991-4b53-4632-b387-97a2c46c9bec ==============================
13:27:10.047002 [info ] [MainThread]: Running with dbt=1.1.0
13:27:10.047657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:27:10.047983 [debug] [MainThread]: Tracking: tracking
13:27:10.066085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab5c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab5300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab4dc0>]}
13:27:10.105147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:27:10.105652 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/marts/lead_time_grain.sql
13:27:10.117053 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_time_grain.sql
13:27:10.181233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaac190>]}
13:27:10.187062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d3fd0>]}
13:27:10.187482 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:27:10.187761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d39d0>]}
13:27:10.189262 [info ] [MainThread]: 
13:27:10.189819 [debug] [MainThread]: Acquiring new postgres connection "master"
13:27:10.190749 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:27:10.200439 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:27:10.200648 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:27:10.200815 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:10.223987 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:27:10.225612 [debug] [ThreadPool]: On list_madisonflagg: Close
13:27:10.227074 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:27:10.233595 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:27:10.233780 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:27:10.233908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:10.238540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:27:10.238714 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:27:10.238840 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:27:10.241765 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
13:27:10.243012 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:27:10.243298 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:27:10.247702 [debug] [MainThread]: Using postgres connection "master"
13:27:10.247897 [debug] [MainThread]: On master: BEGIN
13:27:10.248028 [debug] [MainThread]: Opening a new connection, currently in state init
13:27:10.252890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:27:10.253154 [debug] [MainThread]: Using postgres connection "master"
13:27:10.253316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:27:10.267741 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
13:27:10.269135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e216fb0>]}
13:27:10.269436 [debug] [MainThread]: On master: ROLLBACK
13:27:10.269744 [debug] [MainThread]: Using postgres connection "master"
13:27:10.269870 [debug] [MainThread]: On master: BEGIN
13:27:10.270332 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:27:10.270536 [debug] [MainThread]: On master: COMMIT
13:27:10.270678 [debug] [MainThread]: Using postgres connection "master"
13:27:10.270802 [debug] [MainThread]: On master: COMMIT
13:27:10.271042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:10.271209 [debug] [MainThread]: On master: Close
13:27:10.271561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:27:10.271795 [info ] [MainThread]: 
13:27:10.274765 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:27:10.275033 [info ] [Thread-1 (]: 1 of 5 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:27:10.275437 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.275577 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:27:10.275716 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:27:10.278071 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:27:10.278582 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.278733 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:27:10.301041 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:27:10.301648 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.301782 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:27:10.301896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:10.306890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:10.307154 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.307289 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:27:10.310011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:10.316371 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.316543 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:27:10.317110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.318894 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.319024 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:27:10.319525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.325694 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:27:10.325877 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.325997 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:27:10.326666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:10.331142 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:10.331300 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:27:10.332381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:10.333453 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.333638 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:27:10.334084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4fc400>]}
13:27:10.334443 [info ] [Thread-1 (]: 1 of 5 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:27:10.334884 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:27:10.335122 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:27:10.335425 [info ] [Thread-1 (]: 2 of 5 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:27:10.335820 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.335960 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:27:10.336093 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:27:10.338346 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:27:10.338833 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.338990 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:27:10.341147 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:27:10.341561 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.341691 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:27:10.341806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:10.346753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:10.346991 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.347122 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:27:10.349625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:10.351982 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.352142 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:27:10.352621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.354395 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.354530 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:27:10.354941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.355970 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:27:10.356103 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.356219 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:27:10.356763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:10.358201 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:10.358329 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:27:10.359320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:10.360253 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.360410 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:27:10.360772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f5150>]}
13:27:10.361087 [info ] [Thread-1 (]: 2 of 5 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
13:27:10.361477 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:27:10.361682 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:27:10.361986 [info ] [Thread-1 (]: 3 of 5 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:27:10.362379 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.362516 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:27:10.362645 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:27:10.365061 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:27:10.365654 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.365832 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:27:10.368102 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:27:10.368598 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.368762 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:27:10.368893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:10.373586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:10.373811 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.373932 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:27:10.376601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:10.378917 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.379051 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:27:10.379593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.383102 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.383288 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:27:10.383792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.384895 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:27:10.385050 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.385182 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:27:10.385646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:10.386963 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:10.387131 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:27:10.388154 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:10.389286 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.389468 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:27:10.389846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f324d00>]}
13:27:10.390157 [info ] [Thread-1 (]: 3 of 5 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:27:10.390573 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:27:10.390772 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:27:10.391247 [info ] [Thread-1 (]: 4 of 5 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:27:10.391658 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.391823 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:27:10.391966 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:27:10.394131 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:27:10.394590 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.394763 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:27:10.396865 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:27:10.397418 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.397576 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:27:10.397698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:10.402691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:10.403048 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.403258 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:27:10.406277 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:10.408530 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.408697 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:27:10.409169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.411123 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.411281 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:27:10.411706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.412786 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:27:10.412924 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.413046 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:27:10.413513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:10.414909 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:10.415143 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:27:10.416167 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:10.417161 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.417338 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:27:10.417690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f335570>]}
13:27:10.418006 [info ] [Thread-1 (]: 4 of 5 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:27:10.418428 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:27:10.418745 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_time_grain
13:27:10.419096 [info ] [Thread-1 (]: 5 of 5 START table model fleetio_analyst.lead_time_grain ....................... [RUN]
13:27:10.419509 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.419651 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_time_grain
13:27:10.419785 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_time_grain
13:27:10.422193 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_time_grain"
13:27:10.422828 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.423010 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_time_grain
13:27:10.445635 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_time_grain"
13:27:10.446389 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.446536 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: BEGIN
13:27:10.446657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:10.451362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:10.451596 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.451739 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp"
  as (
    select
    id as lead_id,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at) as converted_at_week,
    date_trunc('month', converted_at) as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  where converted_at is not null
  );
13:27:10.456420 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
13:27:10.459172 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.459472 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain" rename to "lead_time_grain__dbt_backup"
13:27:10.460014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.462156 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.462340 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp" rename to "lead_time_grain"
13:27:10.462876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:10.468101 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:27:10.468308 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.468445 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:27:10.469009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:10.470563 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:10.470714 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_backup" cascade
13:27:10.473111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
13:27:10.474733 [debug] [Thread-1 (]: finished collecting timing info
13:27:10.475060 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: Close
13:27:10.475640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14a1991-4b53-4632-b387-97a2c46c9bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea97310>]}
13:27:10.476126 [info ] [Thread-1 (]: 5 of 5 OK created table model fleetio_analyst.lead_time_grain .................. [[32mSELECT 461[0m in 0.06s]
13:27:10.476745 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_time_grain
13:27:10.478257 [debug] [MainThread]: Acquiring new postgres connection "master"
13:27:10.478574 [debug] [MainThread]: Using postgres connection "master"
13:27:10.478792 [debug] [MainThread]: On master: BEGIN
13:27:10.478978 [debug] [MainThread]: Opening a new connection, currently in state closed
13:27:10.484310 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:27:10.484534 [debug] [MainThread]: On master: COMMIT
13:27:10.484683 [debug] [MainThread]: Using postgres connection "master"
13:27:10.484808 [debug] [MainThread]: On master: COMMIT
13:27:10.485054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:10.485276 [debug] [MainThread]: On master: Close
13:27:10.485746 [info ] [MainThread]: 
13:27:10.486152 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0.30s.
13:27:10.486548 [debug] [MainThread]: Connection 'master' was properly closed.
13:27:10.486781 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_time_grain' was properly closed.
13:27:10.493041 [info ] [MainThread]: 
13:27:10.493355 [info ] [MainThread]: [32mCompleted successfully[0m
13:27:10.493633 [info ] [MainThread]: 
13:27:10.493826 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:27:10.494120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51e260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f33fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f33f9d0>]}


============================== 2022-05-14 13:27:36.840605 | 1d6fdd7f-fa1a-46ae-b908-a9dd595d966d ==============================
13:27:36.840821 [info ] [MainThread]: Running with dbt=1.1.0
13:27:36.841449 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:27:36.841777 [debug] [MainThread]: Tracking: tracking
13:27:36.859603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c9330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c8d60>]}
13:27:36.898117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:27:36.898592 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/marts/lead_time_grain.sql
13:27:36.909831 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_time_grain.sql
13:27:36.970570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c4580>]}
13:27:36.976325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9a860>]}
13:27:36.976743 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:27:36.977013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cab9a0>]}
13:27:36.978456 [info ] [MainThread]: 
13:27:36.978968 [debug] [MainThread]: Acquiring new postgres connection "master"
13:27:36.979943 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:27:36.990684 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:27:36.990935 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:27:36.991066 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:37.010360 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:27:37.011974 [debug] [ThreadPool]: On list_madisonflagg: Close
13:27:37.013718 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:27:37.020160 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:27:37.020386 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:27:37.020522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:37.024849 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:27:37.025048 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:27:37.025182 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:27:37.028218 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
13:27:37.029542 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:27:37.029805 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:27:37.034386 [debug] [MainThread]: Using postgres connection "master"
13:27:37.034653 [debug] [MainThread]: On master: BEGIN
13:27:37.034794 [debug] [MainThread]: Opening a new connection, currently in state init
13:27:37.040267 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:27:37.040533 [debug] [MainThread]: Using postgres connection "master"
13:27:37.040668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:27:37.055051 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
13:27:37.056468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c17730>]}
13:27:37.056769 [debug] [MainThread]: On master: ROLLBACK
13:27:37.057080 [debug] [MainThread]: Using postgres connection "master"
13:27:37.057231 [debug] [MainThread]: On master: BEGIN
13:27:37.057597 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:27:37.057757 [debug] [MainThread]: On master: COMMIT
13:27:37.057894 [debug] [MainThread]: Using postgres connection "master"
13:27:37.058015 [debug] [MainThread]: On master: COMMIT
13:27:37.058246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:37.058413 [debug] [MainThread]: On master: Close
13:27:37.058758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:27:37.058998 [info ] [MainThread]: 
13:27:37.061932 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:27:37.062284 [info ] [Thread-1 (]: 1 of 5 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:27:37.062715 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.062869 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:27:37.063017 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:27:37.065394 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:27:37.066028 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.066255 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:27:37.089835 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:27:37.090489 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.090630 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:27:37.090752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:37.095753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:37.096007 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.096144 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:27:37.098596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:37.104987 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.105164 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:27:37.105730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.107670 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.107820 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:27:37.108295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.114939 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:27:37.115232 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.115373 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:27:37.116060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:37.121073 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:27:37.121281 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:27:37.122450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:37.123914 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.124110 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:27:37.124566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1be50>]}
13:27:37.124937 [info ] [Thread-1 (]: 1 of 5 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:27:37.125378 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:27:37.125597 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:27:37.125960 [info ] [Thread-1 (]: 2 of 5 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:27:37.126369 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.126542 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:27:37.126681 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:27:37.128822 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:27:37.129266 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.129425 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:27:37.131515 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:27:37.131905 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.132038 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:27:37.132157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:37.136716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:37.136970 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.137108 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:27:37.140019 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:37.142540 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.142766 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:27:37.143298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.145365 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.145510 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:27:37.145968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.147135 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:27:37.147312 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.147443 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:27:37.148064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:37.149678 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:27:37.149818 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:27:37.150975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:37.152833 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.153034 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:27:37.153512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dcd120>]}
13:27:37.154084 [info ] [Thread-1 (]: 2 of 5 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
13:27:37.154668 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:27:37.155090 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:27:37.155479 [info ] [Thread-1 (]: 3 of 5 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:27:37.155945 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.156115 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:27:37.156261 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:27:37.158668 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:27:37.159157 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.159367 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:27:37.161652 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:27:37.162159 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.162303 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:27:37.162475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:37.166905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:37.167075 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.167199 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:27:37.170191 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:37.172466 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.172616 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:27:37.173091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.176053 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.176201 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:27:37.176774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.178897 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:27:37.179196 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.179445 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:27:37.180162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:37.181555 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:27:37.181715 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:27:37.182909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:37.184419 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.184756 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:27:37.185261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df8cd0>]}
13:27:37.185664 [info ] [Thread-1 (]: 3 of 5 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:27:37.186147 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:27:37.186413 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:27:37.186914 [info ] [Thread-1 (]: 4 of 5 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:27:37.187365 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.187552 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:27:37.187720 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:27:37.190228 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:27:37.190754 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.190927 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:27:37.193005 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:27:37.193447 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.193590 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:27:37.193718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:37.198880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
13:27:37.199158 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.199307 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:27:37.202015 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:27:37.204251 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.204429 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:27:37.204938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.206783 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.206922 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:27:37.207357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.208398 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:27:37.208536 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.208656 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:27:37.209157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:37.210465 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:27:37.210599 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:27:37.211620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:27:37.212548 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.212711 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:27:37.213061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e09cc0>]}
13:27:37.213377 [info ] [Thread-1 (]: 4 of 5 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:27:37.213775 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:27:37.213959 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_time_grain
13:27:37.214242 [info ] [Thread-1 (]: 5 of 5 START table model fleetio_analyst.lead_time_grain ....................... [RUN]
13:27:37.214632 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.214778 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_time_grain
13:27:37.214917 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_time_grain
13:27:37.217195 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_time_grain"
13:27:37.217769 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.217949 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_time_grain
13:27:37.240383 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_time_grain"
13:27:37.241007 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.241186 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: BEGIN
13:27:37.241306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:27:37.246148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:27:37.246396 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.246536 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp"
  as (
    select
    id as lead_id,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  where converted_at is not null
  );
13:27:37.251369 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
13:27:37.254028 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.254274 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain" rename to "lead_time_grain__dbt_backup"
13:27:37.254800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.256872 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.257048 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp" rename to "lead_time_grain"
13:27:37.257582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:27:37.262853 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:27:37.263076 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.263216 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:27:37.263792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:27:37.265195 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:27:37.265328 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_backup" cascade
13:27:37.267155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
13:27:37.268456 [debug] [Thread-1 (]: finished collecting timing info
13:27:37.268666 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: Close
13:27:37.269199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6fdd7f-fa1a-46ae-b908-a9dd595d966d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c37370>]}
13:27:37.269753 [info ] [Thread-1 (]: 5 of 5 OK created table model fleetio_analyst.lead_time_grain .................. [[32mSELECT 461[0m in 0.05s]
13:27:37.270534 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_time_grain
13:27:37.271694 [debug] [MainThread]: Acquiring new postgres connection "master"
13:27:37.271906 [debug] [MainThread]: Using postgres connection "master"
13:27:37.272037 [debug] [MainThread]: On master: BEGIN
13:27:37.272158 [debug] [MainThread]: Opening a new connection, currently in state closed
13:27:37.276441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:27:37.276631 [debug] [MainThread]: On master: COMMIT
13:27:37.276760 [debug] [MainThread]: Using postgres connection "master"
13:27:37.276881 [debug] [MainThread]: On master: COMMIT
13:27:37.277162 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:27:37.277321 [debug] [MainThread]: On master: Close
13:27:37.277656 [info ] [MainThread]: 
13:27:37.277888 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0.30s.
13:27:37.278156 [debug] [MainThread]: Connection 'master' was properly closed.
13:27:37.278356 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_time_grain' was properly closed.
13:27:37.284352 [info ] [MainThread]: 
13:27:37.284650 [info ] [MainThread]: [32mCompleted successfully[0m
13:27:37.284893 [info ] [MainThread]: 
13:27:37.285084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:27:37.285351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f365c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e0fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e0fc10>]}


============================== 2022-05-14 13:34:08.529062 | 68e3c0d5-4308-470a-bfdc-5cfde65cce57 ==============================
13:34:08.529089 [info ] [MainThread]: Running with dbt=1.1.0
13:34:08.529716 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:34:08.529880 [debug] [MainThread]: Tracking: tracking
13:34:08.547340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070def50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070deec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070dce20>]}
13:34:08.586318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
13:34:08.586892 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/marts/schema.yml
13:34:08.587123 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/marts/lead_time_grain.sql
13:34:08.598447 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_time_grain.sql
13:34:08.660036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4b80>]}
13:34:08.665266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fbdc0>]}
13:34:08.665625 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:34:08.665939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1a80>]}
13:34:08.667334 [info ] [MainThread]: 
13:34:08.667861 [debug] [MainThread]: Acquiring new postgres connection "master"
13:34:08.668770 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:34:08.678852 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:34:08.679102 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:34:08.679234 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:34:08.698484 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:34:08.700005 [debug] [ThreadPool]: On list_madisonflagg: Close
13:34:08.701841 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:34:08.707851 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:34:08.708056 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:34:08.708219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:34:08.713033 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:34:08.713227 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:34:08.713354 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:34:08.716363 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
13:34:08.717688 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:34:08.717946 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:34:08.722157 [debug] [MainThread]: Using postgres connection "master"
13:34:08.722354 [debug] [MainThread]: On master: BEGIN
13:34:08.722492 [debug] [MainThread]: Opening a new connection, currently in state init
13:34:08.726899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:34:08.727139 [debug] [MainThread]: Using postgres connection "master"
13:34:08.727269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:34:08.741867 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
13:34:08.743296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4610>]}
13:34:08.743590 [debug] [MainThread]: On master: ROLLBACK
13:34:08.743882 [debug] [MainThread]: Using postgres connection "master"
13:34:08.744024 [debug] [MainThread]: On master: BEGIN
13:34:08.744440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:34:08.744579 [debug] [MainThread]: On master: COMMIT
13:34:08.744706 [debug] [MainThread]: Using postgres connection "master"
13:34:08.744817 [debug] [MainThread]: On master: COMMIT
13:34:08.745072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:34:08.745234 [debug] [MainThread]: On master: Close
13:34:08.745598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:34:08.745834 [info ] [MainThread]: 
13:34:08.748716 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:34:08.748989 [info ] [Thread-1 (]: 1 of 5 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:34:08.749397 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.749538 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:34:08.749681 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:34:08.752475 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:34:08.753074 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.753254 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:34:08.775265 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:34:08.775903 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.776054 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:34:08.776183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:34:08.781094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:34:08.781345 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.781480 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:34:08.784231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:34:08.790241 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.790392 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:34:08.790899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.792893 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.793085 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:34:08.793596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.799649 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:34:08.799850 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.799981 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:34:08.800615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:34:08.805250 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:34:08.805402 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:34:08.806607 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:34:08.807767 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.807932 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:34:08.808329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e61de0>]}
13:34:08.808700 [info ] [Thread-1 (]: 1 of 5 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:34:08.809154 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:34:08.809373 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:34:08.809772 [info ] [Thread-1 (]: 2 of 5 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:34:08.810192 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.810359 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:34:08.810509 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:34:08.812896 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:34:08.813375 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.813531 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:34:08.815582 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:34:08.815995 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.816163 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:34:08.816286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:34:08.821074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:34:08.821375 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.821520 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:34:08.824043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:34:08.826270 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.826428 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:34:08.826965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.828855 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.829004 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:34:08.829465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.830499 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:34:08.830630 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.830744 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:34:08.831285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:34:08.832680 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:34:08.832810 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:34:08.833890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:34:08.834910 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.835069 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:34:08.835439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107825870>]}
13:34:08.835747 [info ] [Thread-1 (]: 2 of 5 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
13:34:08.836137 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:34:08.836333 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:34:08.836624 [info ] [Thread-1 (]: 3 of 5 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:34:08.837010 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.837146 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:34:08.837276 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:34:08.839577 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:34:08.840120 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.840285 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:34:08.842406 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:34:08.842893 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.843071 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:34:08.843201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:34:08.848108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:34:08.848345 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.848471 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:34:08.850947 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:34:08.854634 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.854772 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:34:08.855246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.856946 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.857076 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:34:08.857543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.858803 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:34:08.858969 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.859103 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:34:08.859732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:34:08.860935 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:34:08.861066 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:34:08.862061 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:34:08.863137 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.863306 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:34:08.863677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107824340>]}
13:34:08.864007 [info ] [Thread-1 (]: 3 of 5 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:34:08.864491 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:34:08.864701 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:34:08.865069 [info ] [Thread-1 (]: 4 of 5 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:34:08.865613 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.865781 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:34:08.865930 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:34:08.868108 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:34:08.868607 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.868782 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:34:08.870863 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:34:08.871322 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.871454 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:34:08.871568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:34:08.876581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:34:08.876812 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.876934 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:34:08.879402 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:34:08.881740 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.881882 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:34:08.882370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.884172 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.884306 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:34:08.884740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.885771 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:34:08.885909 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.886028 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:34:08.886566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:34:08.887944 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:34:08.888078 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:34:08.889081 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:34:08.890026 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.890193 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:34:08.890578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790d360>]}
13:34:08.890884 [info ] [Thread-1 (]: 4 of 5 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:34:08.891287 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:34:08.891492 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_time_grain
13:34:08.891822 [info ] [Thread-1 (]: 5 of 5 START table model fleetio_analyst.lead_time_grain ....................... [RUN]
13:34:08.892220 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.892368 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_time_grain
13:34:08.892509 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_time_grain
13:34:08.894697 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_time_grain"
13:34:08.895196 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.895362 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_time_grain
13:34:08.916995 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_time_grain"
13:34:08.917671 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.917816 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: BEGIN
13:34:08.917935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:34:08.922784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:34:08.922950 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.923070 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp"
  as (
    select
    id as lead_id,
    source,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  where converted_at is not null
  );
13:34:08.928148 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
13:34:08.930782 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.930966 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain" rename to "lead_time_grain__dbt_backup"
13:34:08.931484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.933500 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.933645 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
alter table "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_tmp" rename to "lead_time_grain"
13:34:08.934160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:34:08.939262 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:34:08.939442 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.939572 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: COMMIT
13:34:08.940353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:34:08.941977 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_time_grain"
13:34:08.942112 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_time_grain"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_time_grain__dbt_backup" cascade
13:34:08.944455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
13:34:08.945629 [debug] [Thread-1 (]: finished collecting timing info
13:34:08.945801 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_time_grain: Close
13:34:08.946207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e3c0d5-4308-470a-bfdc-5cfde65cce57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079114b0>]}
13:34:08.946525 [info ] [Thread-1 (]: 5 of 5 OK created table model fleetio_analyst.lead_time_grain .................. [[32mSELECT 461[0m in 0.05s]
13:34:08.946908 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_time_grain
13:34:08.948113 [debug] [MainThread]: Acquiring new postgres connection "master"
13:34:08.948286 [debug] [MainThread]: Using postgres connection "master"
13:34:08.948410 [debug] [MainThread]: On master: BEGIN
13:34:08.948522 [debug] [MainThread]: Opening a new connection, currently in state closed
13:34:08.953066 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:34:08.953297 [debug] [MainThread]: On master: COMMIT
13:34:08.953427 [debug] [MainThread]: Using postgres connection "master"
13:34:08.953548 [debug] [MainThread]: On master: COMMIT
13:34:08.953786 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:34:08.953950 [debug] [MainThread]: On master: Close
13:34:08.954340 [info ] [MainThread]: 
13:34:08.954572 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0.29s.
13:34:08.954773 [debug] [MainThread]: Connection 'master' was properly closed.
13:34:08.954966 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_time_grain' was properly closed.
13:34:08.961346 [info ] [MainThread]: 
13:34:08.961693 [info ] [MainThread]: [32mCompleted successfully[0m
13:34:08.961951 [info ] [MainThread]: 
13:34:08.962154 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
13:34:08.962438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107982350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079827d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107981b10>]}


============================== 2022-05-14 13:48:44.314517 | 109601e6-ff4b-4cc7-9b3d-df597d4aee8f ==============================
13:48:44.314648 [info ] [MainThread]: Running with dbt=1.1.0
13:48:44.315309 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:48:44.315503 [debug] [MainThread]: Tracking: tracking
13:48:44.333485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad17a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad16ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad14e20>]}
13:48:44.374275 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
13:48:44.374680 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/marts/lead_conversion.sql
13:48:44.379024 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/lead_drivers.sql
13:48:44.379688 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/marts/schema.yml
13:48:44.379941 [debug] [MainThread]: Partial parsing: deleted file: fleetio_analyst://models/marts/lead_time_grain.sql
13:48:44.392716 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_conversion.sql
13:48:44.405932 [debug] [MainThread]: 1699: static parser successfully parsed lead_drivers.sql
13:48:44.459077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0cb80>]}
13:48:44.464758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0c400>]}
13:48:44.465130 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:48:44.465380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1feb0>]}
13:48:44.466861 [info ] [MainThread]: 
13:48:44.467298 [debug] [MainThread]: Acquiring new postgres connection "master"
13:48:44.468225 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
13:48:44.477866 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
13:48:44.478137 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
13:48:44.478278 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:48:44.496908 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
13:48:44.498379 [debug] [ThreadPool]: On list_madisonflagg: Close
13:48:44.499961 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:48:44.506204 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:48:44.506388 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:48:44.506515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:48:44.511095 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:48:44.511282 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:48:44.511411 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:48:44.515173 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
13:48:44.516601 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:48:44.516911 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:48:44.521203 [debug] [MainThread]: Using postgres connection "master"
13:48:44.521378 [debug] [MainThread]: On master: BEGIN
13:48:44.521503 [debug] [MainThread]: Opening a new connection, currently in state init
13:48:44.525409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:48:44.525589 [debug] [MainThread]: Using postgres connection "master"
13:48:44.525728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:48:44.540168 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
13:48:44.541598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4e800>]}
13:48:44.541919 [debug] [MainThread]: On master: ROLLBACK
13:48:44.542209 [debug] [MainThread]: Using postgres connection "master"
13:48:44.542365 [debug] [MainThread]: On master: BEGIN
13:48:44.542789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:48:44.542944 [debug] [MainThread]: On master: COMMIT
13:48:44.543079 [debug] [MainThread]: Using postgres connection "master"
13:48:44.543197 [debug] [MainThread]: On master: COMMIT
13:48:44.543450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:48:44.543610 [debug] [MainThread]: On master: Close
13:48:44.543980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:48:44.544220 [info ] [MainThread]: 
13:48:44.547957 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
13:48:44.548288 [info ] [Thread-1 (]: 1 of 6 START view model fleetio_analyst.stg_accounts ........................... [RUN]
13:48:44.548729 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.548876 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
13:48:44.549020 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
13:48:44.551239 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
13:48:44.551779 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.551934 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
13:48:44.573929 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
13:48:44.574550 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.574694 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
13:48:44.574817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.579441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.579706 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.579846 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
13:48:44.582784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:48:44.588728 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.588909 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
13:48:44.589425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.591116 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.591253 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
13:48:44.591654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.598202 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:48:44.598544 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.598723 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
13:48:44.599504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.604264 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
13:48:44.604434 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
13:48:44.605556 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:48:44.606698 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.606857 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
13:48:44.607263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a192080>]}
13:48:44.607586 [info ] [Thread-1 (]: 1 of 6 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
13:48:44.607993 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
13:48:44.608212 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
13:48:44.608537 [info ] [Thread-1 (]: 2 of 6 START view model fleetio_analyst.stg_contacts ........................... [RUN]
13:48:44.608917 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.609057 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
13:48:44.609193 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
13:48:44.611212 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
13:48:44.611677 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.611838 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
13:48:44.613945 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
13:48:44.614356 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.614503 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
13:48:44.614622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.619123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.619300 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.619428 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
13:48:44.621878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:48:44.624273 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.624437 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
13:48:44.624894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.626732 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.626867 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
13:48:44.627343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.628787 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:48:44.628992 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.629171 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
13:48:44.629723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.631267 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
13:48:44.631422 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
13:48:44.632424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:48:44.633404 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.633583 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
13:48:44.633973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4e4a0>]}
13:48:44.634290 [info ] [Thread-1 (]: 2 of 6 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
13:48:44.634687 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
13:48:44.634919 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
13:48:44.635244 [info ] [Thread-1 (]: 3 of 6 START view model fleetio_analyst.stg_leads .............................. [RUN]
13:48:44.635653 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.635804 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
13:48:44.635947 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
13:48:44.638199 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
13:48:44.638680 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.638842 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
13:48:44.642235 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
13:48:44.642753 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.642930 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
13:48:44.643061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.647986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.648220 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.648348 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
13:48:44.650821 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:48:44.653224 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.653381 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
13:48:44.653920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.655584 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.655717 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
13:48:44.656149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.657285 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:48:44.657422 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.657542 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
13:48:44.658082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.659463 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
13:48:44.659618 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
13:48:44.660692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:48:44.661680 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.661847 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
13:48:44.662252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af74730>]}
13:48:44.662562 [info ] [Thread-1 (]: 3 of 6 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
13:48:44.662967 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
13:48:44.663245 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
13:48:44.663643 [info ] [Thread-1 (]: 4 of 6 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
13:48:44.664618 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.665090 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
13:48:44.665297 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
13:48:44.668127 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
13:48:44.668679 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.668864 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
13:48:44.670980 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
13:48:44.671418 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.671554 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
13:48:44.671674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.676607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.676779 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.676902 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
13:48:44.679341 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:48:44.681421 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.681574 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
13:48:44.682061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.683918 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.684055 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
13:48:44.684531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.685717 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:48:44.685877 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.686018 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
13:48:44.686564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.688043 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
13:48:44.688186 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
13:48:44.689226 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:48:44.690154 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.690314 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
13:48:44.690709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fc520>]}
13:48:44.691028 [info ] [Thread-1 (]: 4 of 6 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
13:48:44.691435 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
13:48:44.691678 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_conversion
13:48:44.691991 [info ] [Thread-1 (]: 5 of 6 START table model fleetio_analyst.lead_conversion ....................... [RUN]
13:48:44.692389 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.692528 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_conversion
13:48:44.692663 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_conversion
13:48:44.694938 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_conversion"
13:48:44.695441 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.695615 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_conversion
13:48:44.718475 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_conversion"
13:48:44.719160 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.719299 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: BEGIN
13:48:44.719421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.724192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.724363 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.724487 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp"
  as (
    select
    id as lead_id,
    source,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
  where converted_at is not null
  );
13:48:44.729030 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
13:48:44.731325 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.731511 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp" rename to "lead_conversion"
13:48:44.732081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.737186 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
13:48:44.737341 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.737463 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
13:48:44.738130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.739830 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
13:48:44.739989 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_backup" cascade
13:48:44.740363 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
13:48:44.741402 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.741573 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: Close
13:48:44.741942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3dc60>]}
13:48:44.742340 [info ] [Thread-1 (]: 5 of 6 OK created table model fleetio_analyst.lead_conversion .................. [[32mSELECT 461[0m in 0.05s]
13:48:44.742743 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_conversion
13:48:44.742948 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_drivers
13:48:44.743258 [info ] [Thread-1 (]: 6 of 6 START view model fleetio_analyst.lead_drivers ........................... [RUN]
13:48:44.743659 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.743800 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_drivers
13:48:44.743938 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_drivers
13:48:44.747418 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_drivers"
13:48:44.747918 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.748109 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_drivers
13:48:44.750196 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_drivers"
13:48:44.750648 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.750798 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: BEGIN
13:48:44.750928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:48:44.755538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:48:44.755785 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.755915 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */

  create view "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" as (
    select
    id as lead_id,
    case when converted_at is not null then true else false end as is_converted,
    job_title,
    source,
    industry,
    fleet_size,
    state
from "madisonflagg"."fleetio_analyst"."stg_leads"
  );
13:48:44.758412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
13:48:44.760536 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.760687 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
alter table "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" rename to "lead_drivers"
13:48:44.761168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
13:48:44.762204 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
13:48:44.762341 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.762460 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
13:48:44.763023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
13:48:44.764432 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
13:48:44.764566 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
drop view if exists "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_backup" cascade
13:48:44.764861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
13:48:44.765775 [debug] [Thread-1 (]: finished collecting timing info
13:48:44.765934 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: Close
13:48:44.766325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109601e6-ff4b-4cc7-9b3d-df597d4aee8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa89d0>]}
13:48:44.766638 [info ] [Thread-1 (]: 6 of 6 OK created view model fleetio_analyst.lead_drivers ...................... [[32mCREATE VIEW[0m in 0.02s]
13:48:44.767033 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_drivers
13:48:44.768252 [debug] [MainThread]: Acquiring new postgres connection "master"
13:48:44.768448 [debug] [MainThread]: Using postgres connection "master"
13:48:44.768584 [debug] [MainThread]: On master: BEGIN
13:48:44.768712 [debug] [MainThread]: Opening a new connection, currently in state closed
13:48:44.773213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:48:44.773438 [debug] [MainThread]: On master: COMMIT
13:48:44.773569 [debug] [MainThread]: Using postgres connection "master"
13:48:44.773691 [debug] [MainThread]: On master: COMMIT
13:48:44.773944 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:48:44.774134 [debug] [MainThread]: On master: Close
13:48:44.774539 [info ] [MainThread]: 
13:48:44.774788 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.31s.
13:48:44.775006 [debug] [MainThread]: Connection 'master' was properly closed.
13:48:44.775223 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_drivers' was properly closed.
13:48:44.780790 [info ] [MainThread]: 
13:48:44.781152 [info ] [MainThread]: [32mCompleted successfully[0m
13:48:44.781430 [info ] [MainThread]: 
13:48:44.781628 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
13:48:44.781906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e973a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4ef80>]}


============================== 2022-05-14 13:55:43.873229 | 341ef73e-0b0c-4f74-ba9d-4f07a98c001e ==============================
13:55:43.873254 [info ] [MainThread]: Running with dbt=1.1.0
13:55:43.873885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
13:55:43.874053 [debug] [MainThread]: Tracking: tracking
13:55:43.891590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225ce20>]}
13:55:43.931651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:55:43.932573 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/staging/schema.yml
13:55:43.944230 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_contacts.sql
13:55:43.957096 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_leads.sql
13:55:43.959258 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_opportunities.sql
13:55:43.961506 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_accounts.sql
13:55:44.090967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '341ef73e-0b0c-4f74-ba9d-4f07a98c001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bc3d0>]}
13:55:44.098386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '341ef73e-0b0c-4f74-ba9d-4f07a98c001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bc850>]}
13:55:44.098742 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
13:55:44.098988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341ef73e-0b0c-4f74-ba9d-4f07a98c001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ebf10>]}
13:55:44.100950 [info ] [MainThread]: 
13:55:44.101400 [debug] [MainThread]: Acquiring new postgres connection "master"
13:55:44.102555 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
13:55:44.111952 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:55:44.112152 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
13:55:44.112280 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:55:44.131022 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
13:55:44.131289 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
13:55:44.131426 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
13:55:44.134664 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
13:55:44.136439 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
13:55:44.136804 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
13:55:44.141694 [debug] [MainThread]: Using postgres connection "master"
13:55:44.142026 [debug] [MainThread]: On master: BEGIN
13:55:44.142225 [debug] [MainThread]: Opening a new connection, currently in state init
13:55:44.146596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:55:44.146779 [debug] [MainThread]: Using postgres connection "master"
13:55:44.146920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:55:44.162701 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
13:55:44.164216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341ef73e-0b0c-4f74-ba9d-4f07a98c001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bde10>]}
13:55:44.164518 [debug] [MainThread]: On master: ROLLBACK
13:55:44.164830 [debug] [MainThread]: Using postgres connection "master"
13:55:44.164970 [debug] [MainThread]: On master: BEGIN
13:55:44.165374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:55:44.165514 [debug] [MainThread]: On master: COMMIT
13:55:44.165641 [debug] [MainThread]: Using postgres connection "master"
13:55:44.165752 [debug] [MainThread]: On master: COMMIT
13:55:44.166023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:55:44.166243 [debug] [MainThread]: On master: Close
13:55:44.166592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:55:44.166836 [info ] [MainThread]: 
13:55:44.169910 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d
13:55:44.170158 [info ] [Thread-1 (]: 1 of 12 START test not_null_stg_accounts_id .................................... [RUN]
13:55:44.170604 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"
13:55:44.170747 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d
13:55:44.170923 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d
13:55:44.180974 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"
13:55:44.181726 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.181912 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d
13:55:44.196409 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"
13:55:44.197127 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"
13:55:44.197308 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d: BEGIN
13:55:44.197448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.202205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.202470 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"
13:55:44.202605 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "madisonflagg"."fleetio_analyst"."stg_accounts"
where id is null



      
    ) dbt_internal_test
13:55:44.204345 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.206534 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.206709 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d: ROLLBACK
13:55:44.206961 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d: Close
13:55:44.207347 [info ] [Thread-1 (]: 1 of 12 PASS not_null_stg_accounts_id .......................................... [[32mPASS[0m in 0.04s]
13:55:44.207841 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.not_null_stg_accounts_id.13e82df28d
13:55:44.208100 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6
13:55:44.208499 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_contacts_id .................................... [RUN]
13:55:44.208988 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"
13:55:44.209144 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6
13:55:44.209289 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6
13:55:44.213617 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"
13:55:44.214059 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.214205 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6
13:55:44.215667 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"
13:55:44.216088 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"
13:55:44.216230 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6: BEGIN
13:55:44.216354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.220784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.221017 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"
13:55:44.221144 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "madisonflagg"."fleetio_analyst"."stg_contacts"
where id is null



      
    ) dbt_internal_test
13:55:44.222771 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.224189 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.224380 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6: ROLLBACK
13:55:44.224617 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6: Close
13:55:44.224992 [info ] [Thread-1 (]: 2 of 12 PASS not_null_stg_contacts_id .......................................... [[32mPASS[0m in 0.02s]
13:55:44.225399 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.not_null_stg_contacts_id.4a227ee1b6
13:55:44.225640 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba
13:55:44.225998 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_leads_id ....................................... [RUN]
13:55:44.226677 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"
13:55:44.226971 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba
13:55:44.227210 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba
13:55:44.231926 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"
13:55:44.232608 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.232790 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba
13:55:44.234454 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"
13:55:44.234904 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"
13:55:44.235040 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba: BEGIN
13:55:44.235158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.239419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.239609 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"
13:55:44.239733 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "madisonflagg"."fleetio_analyst"."stg_leads"
where id is null



      
    ) dbt_internal_test
13:55:44.241548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.243532 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.243744 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba: ROLLBACK
13:55:44.244106 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba: Close
13:55:44.244540 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stg_leads_id ............................................. [[32mPASS[0m in 0.02s]
13:55:44.244932 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.not_null_stg_leads_id.fa0805ceba
13:55:44.245128 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063
13:55:44.245428 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_opportunities_id ............................... [RUN]
13:55:44.245883 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"
13:55:44.246067 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063
13:55:44.246271 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063
13:55:44.249899 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"
13:55:44.250344 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.250500 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063
13:55:44.252015 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"
13:55:44.252427 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"
13:55:44.252563 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063: BEGIN
13:55:44.252679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.256579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.256782 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"
13:55:44.256905 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "madisonflagg"."fleetio_analyst"."stg_opportunities"
where id is null



      
    ) dbt_internal_test
13:55:44.258704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.260110 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.260270 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063: ROLLBACK
13:55:44.260547 [debug] [Thread-1 (]: On test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063: Close
13:55:44.260874 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_opportunities_id ..................................... [[32mPASS[0m in 0.02s]
13:55:44.261198 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.not_null_stg_opportunities_id.a3f4693063
13:55:44.261367 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08
13:55:44.261572 [info ] [Thread-1 (]: 5 of 12 START test relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_  [RUN]
13:55:44.261926 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"
13:55:44.262079 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08
13:55:44.262212 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08
13:55:44.266621 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"
13:55:44.267035 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.267180 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08
13:55:44.268579 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"
13:55:44.269007 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"
13:55:44.269138 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08: BEGIN
13:55:44.269252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.273360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.273611 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"
13:55:44.273858 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select primary_contact_id as from_field
    from "madisonflagg"."fleetio_analyst"."stg_accounts"
    where primary_contact_id is not null
),

parent as (
    select id as to_field
    from "madisonflagg"."fleetio_analyst"."stg_contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
13:55:44.276488 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.278204 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.278387 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08: ROLLBACK
13:55:44.278647 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08: Close
13:55:44.279018 [info ] [Thread-1 (]: 5 of 12 PASS relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_  [[32mPASS[0m in 0.02s]
13:55:44.279386 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.relationships_stg_accounts_primary_contact_id__id__ref_stg_contacts_.bc33128e08
13:55:44.279592 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843
13:55:44.279854 [info ] [Thread-1 (]: 6 of 12 START test relationships_stg_contacts_account_id__id__ref_stg_accounts_  [RUN]
13:55:44.280346 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"
13:55:44.280501 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843
13:55:44.280660 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843
13:55:44.285324 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"
13:55:44.285853 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.286010 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843
13:55:44.287377 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"
13:55:44.287770 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"
13:55:44.287911 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843: BEGIN
13:55:44.288024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.292895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.293069 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"
13:55:44.293273 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_id as from_field
    from "madisonflagg"."fleetio_analyst"."stg_contacts"
    where account_id is not null
),

parent as (
    select id as to_field
    from "madisonflagg"."fleetio_analyst"."stg_accounts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
13:55:44.295757 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.297278 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.297453 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843: ROLLBACK
13:55:44.297689 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843: Close
13:55:44.298048 [info ] [Thread-1 (]: 6 of 12 PASS relationships_stg_contacts_account_id__id__ref_stg_accounts_ ...... [[32mPASS[0m in 0.02s]
13:55:44.298441 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.relationships_stg_contacts_account_id__id__ref_stg_accounts_.349a9ba843
13:55:44.298619 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a
13:55:44.298830 [info ] [Thread-1 (]: 7 of 12 START test relationships_stg_contacts_lead_id__id__ref_stg_leads_ ...... [RUN]
13:55:44.299194 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"
13:55:44.299329 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a
13:55:44.299453 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a
13:55:44.303661 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"
13:55:44.304150 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.304315 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a
13:55:44.305743 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"
13:55:44.306150 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"
13:55:44.306283 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a: BEGIN
13:55:44.306400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.311383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.311619 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"
13:55:44.311741 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select lead_id as from_field
    from "madisonflagg"."fleetio_analyst"."stg_contacts"
    where lead_id is not null
),

parent as (
    select id as to_field
    from "madisonflagg"."fleetio_analyst"."stg_leads"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
13:55:44.314698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.316306 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.316478 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a: ROLLBACK
13:55:44.316793 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a: Close
13:55:44.317261 [info ] [Thread-1 (]: 7 of 12 PASS relationships_stg_contacts_lead_id__id__ref_stg_leads_ ............ [[32mPASS[0m in 0.02s]
13:55:44.317679 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.relationships_stg_contacts_lead_id__id__ref_stg_leads_.f0f83a4e6a
13:55:44.317864 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2
13:55:44.318115 [info ] [Thread-1 (]: 8 of 12 START test relationships_stg_opportunities_account_id__id__ref_stg_accounts_  [RUN]
13:55:44.318549 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"
13:55:44.318698 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2
13:55:44.318837 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2
13:55:44.325115 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"
13:55:44.325932 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.326110 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2
13:55:44.327595 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"
13:55:44.328037 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"
13:55:44.328171 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2: BEGIN
13:55:44.328286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.333256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.333467 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"
13:55:44.333620 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_id as from_field
    from "madisonflagg"."fleetio_analyst"."stg_opportunities"
    where account_id is not null
),

parent as (
    select id as to_field
    from "madisonflagg"."fleetio_analyst"."stg_accounts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
13:55:44.336357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.338040 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.338218 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2: ROLLBACK
13:55:44.338482 [debug] [Thread-1 (]: On test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2: Close
13:55:44.338853 [info ] [Thread-1 (]: 8 of 12 PASS relationships_stg_opportunities_account_id__id__ref_stg_accounts_ . [[32mPASS[0m in 0.02s]
13:55:44.339218 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.relationships_stg_opportunities_account_id__id__ref_stg_accounts_.c947babcc2
13:55:44.339394 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.unique_stg_accounts_id.9386f1808a
13:55:44.339621 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_accounts_id ...................................... [RUN]
13:55:44.339996 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"
13:55:44.340132 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.unique_stg_accounts_id.9386f1808a
13:55:44.340263 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.unique_stg_accounts_id.9386f1808a
13:55:44.346287 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"
13:55:44.346775 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.346944 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.unique_stg_accounts_id.9386f1808a
13:55:44.348342 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"
13:55:44.348740 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"
13:55:44.348874 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_accounts_id.9386f1808a: BEGIN
13:55:44.349012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.353870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.354107 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"
13:55:44.354229 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_accounts_id.9386f1808a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.unique_stg_accounts_id.9386f1808a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "madisonflagg"."fleetio_analyst"."stg_accounts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
13:55:44.356551 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.358257 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.358454 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_accounts_id.9386f1808a: ROLLBACK
13:55:44.358754 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_accounts_id.9386f1808a: Close
13:55:44.359143 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_accounts_id ............................................ [[32mPASS[0m in 0.02s]
13:55:44.359506 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.unique_stg_accounts_id.9386f1808a
13:55:44.359683 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1
13:55:44.359910 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_contacts_id ..................................... [RUN]
13:55:44.360269 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"
13:55:44.360406 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1
13:55:44.360537 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1
13:55:44.363834 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"
13:55:44.364297 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.364442 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1
13:55:44.365761 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"
13:55:44.366156 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"
13:55:44.366289 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1: BEGIN
13:55:44.366412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.370807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.370968 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"
13:55:44.371089 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "madisonflagg"."fleetio_analyst"."stg_contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
13:55:44.373161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.374677 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.374874 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1: ROLLBACK
13:55:44.375166 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1: Close
13:55:44.376353 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_contacts_id ........................................... [[32mPASS[0m in 0.02s]
13:55:44.377111 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.unique_stg_contacts_id.2b31825ce1
13:55:44.377400 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb
13:55:44.377679 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_leads_id ........................................ [RUN]
13:55:44.378162 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"
13:55:44.378312 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb
13:55:44.378452 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb
13:55:44.381976 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"
13:55:44.382432 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.382581 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb
13:55:44.384133 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"
13:55:44.384592 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"
13:55:44.384734 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb: BEGIN
13:55:44.384858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.389077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:55:44.389266 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"
13:55:44.389395 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "madisonflagg"."fleetio_analyst"."stg_leads"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
13:55:44.391961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.393294 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.393450 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb: ROLLBACK
13:55:44.393684 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb: Close
13:55:44.394058 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_leads_id .............................................. [[32mPASS[0m in 0.02s]
13:55:44.394420 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.unique_stg_leads_id.a5b9a514fb
13:55:44.394603 [debug] [Thread-1 (]: Began running node test.fleetio_analyst.unique_stg_opportunities_id.345436df3c
13:55:44.394827 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_opportunities_id ................................ [RUN]
13:55:44.395216 [debug] [Thread-1 (]: Acquiring new postgres connection "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"
13:55:44.395359 [debug] [Thread-1 (]: Began compiling node test.fleetio_analyst.unique_stg_opportunities_id.345436df3c
13:55:44.395492 [debug] [Thread-1 (]: Compiling test.fleetio_analyst.unique_stg_opportunities_id.345436df3c
13:55:44.398754 [debug] [Thread-1 (]: Writing injected SQL for node "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"
13:55:44.399195 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.399355 [debug] [Thread-1 (]: Began executing node test.fleetio_analyst.unique_stg_opportunities_id.345436df3c
13:55:44.400766 [debug] [Thread-1 (]: Writing runtime SQL for node "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"
13:55:44.401176 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"
13:55:44.401334 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_opportunities_id.345436df3c: BEGIN
13:55:44.401464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:55:44.406504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
13:55:44.406771 [debug] [Thread-1 (]: Using postgres connection "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"
13:55:44.406930 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_opportunities_id.345436df3c: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "test.fleetio_analyst.unique_stg_opportunities_id.345436df3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "madisonflagg"."fleetio_analyst"."stg_opportunities"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
13:55:44.409747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
13:55:44.411283 [debug] [Thread-1 (]: finished collecting timing info
13:55:44.411451 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_opportunities_id.345436df3c: ROLLBACK
13:55:44.411741 [debug] [Thread-1 (]: On test.fleetio_analyst.unique_stg_opportunities_id.345436df3c: Close
13:55:44.412188 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_opportunities_id ...................................... [[32mPASS[0m in 0.02s]
13:55:44.412568 [debug] [Thread-1 (]: Finished running node test.fleetio_analyst.unique_stg_opportunities_id.345436df3c
13:55:44.413761 [debug] [MainThread]: Acquiring new postgres connection "master"
13:55:44.413976 [debug] [MainThread]: Using postgres connection "master"
13:55:44.414115 [debug] [MainThread]: On master: BEGIN
13:55:44.414233 [debug] [MainThread]: Opening a new connection, currently in state closed
13:55:44.418559 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:55:44.418755 [debug] [MainThread]: On master: COMMIT
13:55:44.418890 [debug] [MainThread]: Using postgres connection "master"
13:55:44.419015 [debug] [MainThread]: On master: COMMIT
13:55:44.419280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:55:44.419435 [debug] [MainThread]: On master: Close
13:55:44.419750 [info ] [MainThread]: 
13:55:44.419970 [info ] [MainThread]: Finished running 12 tests in 0.32s.
13:55:44.420170 [debug] [MainThread]: Connection 'master' was properly closed.
13:55:44.420336 [debug] [MainThread]: Connection 'test.fleetio_analyst.unique_stg_opportunities_id.345436df3c' was properly closed.
13:55:44.426224 [info ] [MainThread]: 
13:55:44.426516 [info ] [MainThread]: [32mCompleted successfully[0m
13:55:44.426774 [info ] [MainThread]: 
13:55:44.426987 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
13:55:44.427291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112260f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122612d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bd3c0>]}


============================== 2022-05-14 14:02:03.108778 | 948a8638-ac37-4ccf-9f42-0555a7704460 ==============================
14:02:03.108802 [info ] [MainThread]: Running with dbt=1.1.0
14:02:03.109442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:02:03.109600 [debug] [MainThread]: Tracking: tracking
14:02:03.128059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec4e20>]}
14:02:03.169659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:02:03.170235 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/marts/lead_conversion.sql
14:02:03.170508 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/lead_drivers.sql
14:02:03.182269 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_conversion.sql
14:02:03.195470 [debug] [MainThread]: 1699: static parser successfully parsed lead_drivers.sql
14:02:03.251373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113552350>]}
14:02:03.258602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113615300>]}
14:02:03.258986 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
14:02:03.259278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113615330>]}
14:02:03.261002 [info ] [MainThread]: 
14:02:03.261500 [debug] [MainThread]: Acquiring new postgres connection "master"
14:02:03.262519 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
14:02:03.272051 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
14:02:03.272230 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
14:02:03.272363 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:02:03.291372 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
14:02:03.292811 [debug] [ThreadPool]: On list_madisonflagg: Close
14:02:03.294784 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
14:02:03.300679 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:02:03.300860 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
14:02:03.300988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:02:03.305382 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:02:03.305562 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:02:03.305688 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
14:02:03.308662 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:02:03.310015 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
14:02:03.310280 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
14:02:03.316243 [debug] [MainThread]: Using postgres connection "master"
14:02:03.316642 [debug] [MainThread]: On master: BEGIN
14:02:03.316791 [debug] [MainThread]: Opening a new connection, currently in state init
14:02:03.321642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:02:03.321814 [debug] [MainThread]: Using postgres connection "master"
14:02:03.321946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:02:03.337958 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
14:02:03.339401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113651de0>]}
14:02:03.339689 [debug] [MainThread]: On master: ROLLBACK
14:02:03.339994 [debug] [MainThread]: Using postgres connection "master"
14:02:03.340152 [debug] [MainThread]: On master: BEGIN
14:02:03.340557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:02:03.340699 [debug] [MainThread]: On master: COMMIT
14:02:03.340857 [debug] [MainThread]: Using postgres connection "master"
14:02:03.341019 [debug] [MainThread]: On master: COMMIT
14:02:03.341308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:02:03.341450 [debug] [MainThread]: On master: Close
14:02:03.341817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:02:03.342056 [info ] [MainThread]: 
14:02:03.345308 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
14:02:03.345606 [info ] [Thread-1 (]: 1 of 6 START view model fleetio_analyst.stg_accounts ........................... [RUN]
14:02:03.346016 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.346165 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
14:02:03.346310 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
14:02:03.348632 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
14:02:03.349195 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.349349 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
14:02:03.370823 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
14:02:03.371390 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.371560 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
14:02:03.371690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.376489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.376760 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.376899 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
14:02:03.379635 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:02:03.386154 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.386330 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:02:03.386829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.388655 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.388821 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:02:03.389286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.395292 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:02:03.395488 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.395623 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:02:03.396299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:02:03.400672 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:02:03.400818 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
14:02:03.402012 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:02:03.403200 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.403385 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
14:02:03.403823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec47c0>]}
14:02:03.404172 [info ] [Thread-1 (]: 1 of 6 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
14:02:03.404619 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
14:02:03.404858 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
14:02:03.405239 [info ] [Thread-1 (]: 2 of 6 START view model fleetio_analyst.stg_contacts ........................... [RUN]
14:02:03.405648 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.405792 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
14:02:03.405927 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
14:02:03.408349 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
14:02:03.408805 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.408971 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
14:02:03.411036 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
14:02:03.411857 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.412092 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
14:02:03.412264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.417019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.417300 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.417459 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
14:02:03.419875 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:02:03.422239 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.422384 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
14:02:03.422801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.424668 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.424817 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
14:02:03.425283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.426332 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:02:03.426472 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.426595 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:02:03.427130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:02:03.428373 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:02:03.428509 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
14:02:03.429588 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:02:03.431972 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.432146 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
14:02:03.432500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137379d0>]}
14:02:03.432818 [info ] [Thread-1 (]: 2 of 6 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
14:02:03.433206 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
14:02:03.433398 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
14:02:03.433705 [info ] [Thread-1 (]: 3 of 6 START view model fleetio_analyst.stg_leads .............................. [RUN]
14:02:03.434090 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.434232 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
14:02:03.434367 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
14:02:03.436704 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
14:02:03.437197 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.437365 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
14:02:03.439671 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
14:02:03.440283 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.440455 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
14:02:03.440584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.445366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.445576 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.445705 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
14:02:03.448620 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:02:03.450999 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.451151 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
14:02:03.451614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.453421 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.453566 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
14:02:03.454038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.455075 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:02:03.455217 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.455344 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:02:03.455913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:02:03.457182 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:02:03.457314 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
14:02:03.458589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:02:03.459657 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.459818 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
14:02:03.460209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e10430>]}
14:02:03.460529 [info ] [Thread-1 (]: 3 of 6 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
14:02:03.460949 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
14:02:03.461145 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
14:02:03.461653 [info ] [Thread-1 (]: 4 of 6 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
14:02:03.462097 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.462242 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
14:02:03.462378 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
14:02:03.464708 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
14:02:03.465265 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.465427 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
14:02:03.467555 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
14:02:03.468011 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.468145 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
14:02:03.468264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.473214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.473445 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.473573 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
14:02:03.476058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:02:03.478470 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.478613 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
14:02:03.479108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.481472 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.481665 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
14:02:03.482205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.483592 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:02:03.483767 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.483920 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:02:03.484549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:02:03.486191 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:02:03.486341 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
14:02:03.487582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:02:03.488674 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.488841 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
14:02:03.489201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113718ca0>]}
14:02:03.489525 [info ] [Thread-1 (]: 4 of 6 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
14:02:03.489935 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
14:02:03.490141 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_conversion
14:02:03.490582 [info ] [Thread-1 (]: 5 of 6 START table model fleetio_analyst.lead_conversion ....................... [RUN]
14:02:03.490959 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.491094 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_conversion
14:02:03.491222 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_conversion
14:02:03.493366 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_conversion"
14:02:03.494024 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.494185 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_conversion
14:02:03.515933 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_conversion"
14:02:03.516732 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.516910 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: BEGIN
14:02:03.517039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.521763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.521926 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.522046 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp"
  as (
    select
    id as lead_id,
    source,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
    where converted_at is not null
  );
14:02:03.526713 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
14:02:03.530395 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.530554 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion" rename to "lead_conversion__dbt_backup"
14:02:03.531000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.533127 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.533283 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp" rename to "lead_conversion"
14:02:03.533794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:02:03.538867 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:02:03.539026 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.539143 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:02:03.539946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:02:03.541570 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:02:03.541705 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_backup" cascade
14:02:03.543874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
14:02:03.545236 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.545420 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: Close
14:02:03.545975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137bc8b0>]}
14:02:03.546353 [info ] [Thread-1 (]: 5 of 6 OK created table model fleetio_analyst.lead_conversion .................. [[32mSELECT 461[0m in 0.06s]
14:02:03.546761 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_conversion
14:02:03.547014 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_drivers
14:02:03.547314 [info ] [Thread-1 (]: 6 of 6 START view model fleetio_analyst.lead_drivers ........................... [RUN]
14:02:03.547721 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_drivers"
14:02:03.547858 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_drivers
14:02:03.547988 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_drivers
14:02:03.550620 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_drivers"
14:02:03.551101 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.551268 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_drivers
14:02:03.553516 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_drivers"
14:02:03.553943 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:02:03.554072 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: BEGIN
14:02:03.554185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:02:03.558786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:02:03.559012 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:02:03.559136 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */

  create view "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" as (
    with lead_and_accoun_info as (

    select
        l.*,
        a.id as account_id
    from "madisonflagg"."fleetio_analyst"."stg_leads" l
    left join "madisonflagg"."fleetio_analyst"."stg_accounts" a
        on l.id = a.lead_id

)

select
    l.id as lead_id,
    case when converted_at is not null then true else false end as is_converted,
    o.is_closed,
    o.is_won,
    l.job_title,
    l.source,
    l.industry,
    l.fleet_size,
    l.state
from lead_and_account_info l
left join "madisonflagg"."fleetio_analyst"."stg_opportunities" o on l.account_id = o.account_id
  );
14:02:03.560230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.lead_id does not exist
LINE 11:         on l.id = a.lead_id
                           ^

14:02:03.560391 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: ROLLBACK
14:02:03.560751 [debug] [Thread-1 (]: finished collecting timing info
14:02:03.560911 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: Close
14:02:03.561226 [debug] [Thread-1 (]: Database Error in model lead_drivers (models/lead_drivers.sql)
  column a.lead_id does not exist
  LINE 11:         on l.id = a.lead_id
                             ^
  compiled SQL at target/run/fleetio_analyst/models/lead_drivers.sql
14:02:03.561473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '948a8638-ac37-4ccf-9f42-0555a7704460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136fa860>]}
14:02:03.561787 [error] [Thread-1 (]: 6 of 6 ERROR creating view model fleetio_analyst.lead_drivers .................. [[31mERROR[0m in 0.01s]
14:02:03.562178 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_drivers
14:02:03.563223 [debug] [MainThread]: Acquiring new postgres connection "master"
14:02:03.563408 [debug] [MainThread]: Using postgres connection "master"
14:02:03.563541 [debug] [MainThread]: On master: BEGIN
14:02:03.563662 [debug] [MainThread]: Opening a new connection, currently in state closed
14:02:03.567904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:02:03.568146 [debug] [MainThread]: On master: COMMIT
14:02:03.568276 [debug] [MainThread]: Using postgres connection "master"
14:02:03.568399 [debug] [MainThread]: On master: COMMIT
14:02:03.568664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:02:03.568853 [debug] [MainThread]: On master: Close
14:02:03.569269 [info ] [MainThread]: 
14:02:03.569517 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.31s.
14:02:03.569741 [debug] [MainThread]: Connection 'master' was properly closed.
14:02:03.569857 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_drivers' was properly closed.
14:02:03.575437 [info ] [MainThread]: 
14:02:03.575679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:02:03.575914 [info ] [MainThread]: 
14:02:03.576122 [error] [MainThread]: [33mDatabase Error in model lead_drivers (models/lead_drivers.sql)[0m
14:02:03.576309 [error] [MainThread]:   column a.lead_id does not exist
14:02:03.576483 [error] [MainThread]:   LINE 11:         on l.id = a.lead_id
14:02:03.576653 [error] [MainThread]:                              ^
14:02:03.576822 [error] [MainThread]:   compiled SQL at target/run/fleetio_analyst/models/lead_drivers.sql
14:02:03.577007 [info ] [MainThread]: 
14:02:03.577189 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:02:03.577449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136322f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113633010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113616200>]}


============================== 2022-05-14 14:04:30.476082 | f68e9726-ea08-423a-a1a2-e278b2f29293 ==============================
14:04:30.476107 [info ] [MainThread]: Running with dbt=1.1.0
14:04:30.476869 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:04:30.477180 [debug] [MainThread]: Tracking: tracking
14:04:30.494337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ada50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ad330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109acd60>]}
14:04:30.535338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:04:30.536101 [debug] [MainThread]: Partial parsing: update schema file: fleetio_analyst://models/marts/schema.yml
14:04:30.536311 [debug] [MainThread]: Partial parsing: updated file: fleetio_analyst://models/lead_drivers.sql
14:04:30.547760 [debug] [MainThread]: 1699: static parser successfully parsed lead_drivers.sql
14:04:30.611221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103d990>]}
14:04:30.618475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c0040>]}
14:04:30.618878 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
14:04:30.619226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110426620>]}
14:04:30.621155 [info ] [MainThread]: 
14:04:30.621710 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:30.622891 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
14:04:30.632651 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
14:04:30.632917 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
14:04:30.633076 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:30.655828 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
14:04:30.657424 [debug] [ThreadPool]: On list_madisonflagg: Close
14:04:30.659023 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
14:04:30.664859 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:04:30.665060 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
14:04:30.665188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:04:30.670211 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:04:30.670394 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:04:30.670521 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
14:04:30.673451 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
14:04:30.674764 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
14:04:30.675035 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
14:04:30.679813 [debug] [MainThread]: Using postgres connection "master"
14:04:30.680019 [debug] [MainThread]: On master: BEGIN
14:04:30.680151 [debug] [MainThread]: Opening a new connection, currently in state init
14:04:30.685248 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:04:30.685497 [debug] [MainThread]: Using postgres connection "master"
14:04:30.685635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:04:30.701085 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
14:04:30.702560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111103700>]}
14:04:30.702847 [debug] [MainThread]: On master: ROLLBACK
14:04:30.703172 [debug] [MainThread]: Using postgres connection "master"
14:04:30.703305 [debug] [MainThread]: On master: BEGIN
14:04:30.703744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:30.703893 [debug] [MainThread]: On master: COMMIT
14:04:30.704023 [debug] [MainThread]: Using postgres connection "master"
14:04:30.704138 [debug] [MainThread]: On master: COMMIT
14:04:30.704442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:30.704595 [debug] [MainThread]: On master: Close
14:04:30.704961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:04:30.705196 [info ] [MainThread]: 
14:04:30.708028 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
14:04:30.708324 [info ] [Thread-1 (]: 1 of 6 START view model fleetio_analyst.stg_accounts ........................... [RUN]
14:04:30.708769 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.708908 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
14:04:30.709048 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
14:04:30.711274 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
14:04:30.711775 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.711929 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
14:04:30.733984 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
14:04:30.734666 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.734803 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
14:04:30.734920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.739668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.739944 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.740082 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
14:04:30.742518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:04:30.748514 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.748727 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:04:30.749264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.751182 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.751370 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:04:30.751983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.758153 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:04:30.758334 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.758459 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:04:30.759156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.763586 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:04:30.763744 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
14:04:30.764868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:04:30.765983 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.766181 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
14:04:30.766566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009b550>]}
14:04:30.766925 [info ] [Thread-1 (]: 1 of 6 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
14:04:30.767351 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
14:04:30.767555 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
14:04:30.767869 [info ] [Thread-1 (]: 2 of 6 START view model fleetio_analyst.stg_contacts ........................... [RUN]
14:04:30.768272 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.768411 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
14:04:30.768546 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
14:04:30.770750 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
14:04:30.771227 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.771409 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
14:04:30.773530 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
14:04:30.773969 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.774103 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
14:04:30.774219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.779154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.779391 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.779519 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
14:04:30.781770 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:04:30.784179 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.784332 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
14:04:30.784846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.786617 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.786752 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
14:04:30.787135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.788156 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:04:30.788296 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.788415 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:04:30.788915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.790296 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:04:30.790433 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
14:04:30.791501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:04:30.793847 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.794016 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
14:04:30.794403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111102950>]}
14:04:30.794711 [info ] [Thread-1 (]: 2 of 6 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
14:04:30.795144 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
14:04:30.795366 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
14:04:30.795673 [info ] [Thread-1 (]: 3 of 6 START view model fleetio_analyst.stg_leads .............................. [RUN]
14:04:30.796072 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.796219 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
14:04:30.796350 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
14:04:30.798572 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
14:04:30.799043 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.799212 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
14:04:30.801365 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
14:04:30.801961 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.802109 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
14:04:30.802236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.806995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.807229 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.807365 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
14:04:30.810030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:04:30.812215 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.812350 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
14:04:30.812894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.814671 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.814803 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
14:04:30.815222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.816208 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:04:30.816344 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.816464 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:04:30.816999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.818609 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:04:30.818795 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
14:04:30.819958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:04:30.820898 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.821059 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
14:04:30.821442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111125f90>]}
14:04:30.821752 [info ] [Thread-1 (]: 3 of 6 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
14:04:30.822230 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
14:04:30.822414 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
14:04:30.822726 [info ] [Thread-1 (]: 4 of 6 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
14:04:30.823236 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.823448 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
14:04:30.823614 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
14:04:30.825877 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
14:04:30.826319 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.826487 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
14:04:30.828500 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
14:04:30.828916 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.829082 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
14:04:30.829200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.834105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.834344 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.834470 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
14:04:30.837043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:04:30.839401 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.839543 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
14:04:30.840057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.841807 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.841957 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
14:04:30.842453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.843535 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:04:30.843688 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.843814 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:04:30.844303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.845708 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:04:30.845842 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
14:04:30.846913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:04:30.847908 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.848070 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
14:04:30.848423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112044c0>]}
14:04:30.848744 [info ] [Thread-1 (]: 4 of 6 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
14:04:30.849134 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
14:04:30.849336 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_conversion
14:04:30.849659 [info ] [Thread-1 (]: 5 of 6 START table model fleetio_analyst.lead_conversion ....................... [RUN]
14:04:30.850202 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.850353 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_conversion
14:04:30.850488 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_conversion
14:04:30.852679 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_conversion"
14:04:30.853181 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.853342 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_conversion
14:04:30.875365 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_conversion"
14:04:30.876013 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.876179 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: BEGIN
14:04:30.876310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.880875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.881046 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.881168 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp"
  as (
    select
    id as lead_id,
    source,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
    where converted_at is not null
  );
14:04:30.886121 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.0 seconds
14:04:30.890052 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.890253 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion" rename to "lead_conversion__dbt_backup"
14:04:30.890810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.893018 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.893186 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp" rename to "lead_conversion"
14:04:30.893724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.898837 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:04:30.899035 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.899159 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:04:30.899869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.901436 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:04:30.901569 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_backup" cascade
14:04:30.903521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
14:04:30.904719 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.904905 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: Close
14:04:30.905347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111103550>]}
14:04:30.905688 [info ] [Thread-1 (]: 5 of 6 OK created table model fleetio_analyst.lead_conversion .................. [[32mSELECT 461[0m in 0.06s]
14:04:30.906085 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_conversion
14:04:30.906293 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_drivers
14:04:30.906599 [info ] [Thread-1 (]: 6 of 6 START view model fleetio_analyst.lead_drivers ........................... [RUN]
14:04:30.906993 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.907132 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_drivers
14:04:30.907263 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_drivers
14:04:30.910664 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_drivers"
14:04:30.911164 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.911327 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_drivers
14:04:30.913366 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_drivers"
14:04:30.913815 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.913946 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: BEGIN
14:04:30.914063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:04:30.918884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:04:30.919106 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.919232 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */

  create view "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" as (
    with lead_and_account_info as (

    select
        l.*,
        c.account_id as account_id
    from "madisonflagg"."fleetio_analyst"."stg_leads" l
    left join "madisonflagg"."fleetio_analyst"."stg_contacts" c
        on l.id = c.lead_id

)

select
    l.id as lead_id,
    case when converted_at is not null then true else false end as is_converted,
    o.is_closed,
    o.is_won,
    l.job_title,
    l.source,
    l.industry,
    l.fleet_size,
    l.state
from lead_and_account_info l
left join "madisonflagg"."fleetio_analyst"."stg_opportunities" o on l.account_id = o.account_id
  );
14:04:30.922529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:04:30.924903 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.925046 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
alter table "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" rename to "lead_drivers"
14:04:30.925608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:04:30.926657 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
14:04:30.926798 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.926919 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
14:04:30.927448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:04:30.928859 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:04:30.929008 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
drop view if exists "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_backup" cascade
14:04:30.929350 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:04:30.930322 [debug] [Thread-1 (]: finished collecting timing info
14:04:30.930480 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: Close
14:04:30.930851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68e9726-ea08-423a-a1a2-e278b2f29293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111264550>]}
14:04:30.931156 [info ] [Thread-1 (]: 6 of 6 OK created view model fleetio_analyst.lead_drivers ...................... [[32mCREATE VIEW[0m in 0.02s]
14:04:30.931551 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_drivers
14:04:30.932733 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:30.932913 [debug] [MainThread]: Using postgres connection "master"
14:04:30.933040 [debug] [MainThread]: On master: BEGIN
14:04:30.933154 [debug] [MainThread]: Opening a new connection, currently in state closed
14:04:30.937862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:30.938103 [debug] [MainThread]: On master: COMMIT
14:04:30.938230 [debug] [MainThread]: Using postgres connection "master"
14:04:30.938352 [debug] [MainThread]: On master: COMMIT
14:04:30.938589 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:30.938747 [debug] [MainThread]: On master: Close
14:04:30.939171 [info ] [MainThread]: 
14:04:30.939411 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.32s.
14:04:30.939638 [debug] [MainThread]: Connection 'master' was properly closed.
14:04:30.939893 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_drivers' was properly closed.
14:04:30.945833 [info ] [MainThread]: 
14:04:30.946123 [info ] [MainThread]: [32mCompleted successfully[0m
14:04:30.946399 [info ] [MainThread]: 
14:04:30.946606 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
14:04:30.946919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110426620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a9780>]}


============================== 2022-05-14 14:13:24.132731 | 817a4a6b-3546-4b8b-ac0d-2d1d91daf253 ==============================
14:13:24.132756 [info ] [MainThread]: Running with dbt=1.1.0
14:13:24.133372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/madisonflagg/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:13:24.133531 [debug] [MainThread]: Tracking: tracking
14:13:24.154298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110594fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110596ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110594e20>]}
14:13:24.196366 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
14:13:24.196795 [debug] [MainThread]: Partial parsing: added file: fleetio_analyst://models/marts/lead_drivers.sql
14:13:24.196976 [debug] [MainThread]: Partial parsing: deleted file: fleetio_analyst://models/lead_drivers.sql
14:13:24.208349 [debug] [MainThread]: 1699: static parser successfully parsed marts/lead_drivers.sql
14:13:24.274094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf1ba0>]}
14:13:24.282054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca41c0>]}
14:13:24.282419 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 4 seed files, 0 sources, 0 exposures, 0 metrics
14:13:24.282689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca4220>]}
14:13:24.284341 [info ] [MainThread]: 
14:13:24.284776 [debug] [MainThread]: Acquiring new postgres connection "master"
14:13:24.285721 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg"
14:13:24.294865 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg"
14:13:24.295057 [debug] [ThreadPool]: On list_madisonflagg: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg"} */

    select distinct nspname from pg_namespace
  
14:13:24.295183 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:13:24.315127 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
14:13:24.316614 [debug] [ThreadPool]: On list_madisonflagg: Close
14:13:24.318349 [debug] [ThreadPool]: Acquiring new postgres connection "list_madisonflagg_fleetio_analyst"
14:13:24.324271 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:13:24.324466 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: BEGIN
14:13:24.324601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:13:24.329872 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:13:24.330053 [debug] [ThreadPool]: Using postgres connection "list_madisonflagg_fleetio_analyst"
14:13:24.330177 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "list_madisonflagg_fleetio_analyst"} */
select
      'madisonflagg' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'fleetio_analyst'
    union all
    select
      'madisonflagg' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'fleetio_analyst'
  
14:13:24.333158 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:13:24.334495 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: ROLLBACK
14:13:24.334760 [debug] [ThreadPool]: On list_madisonflagg_fleetio_analyst: Close
14:13:24.339634 [debug] [MainThread]: Using postgres connection "master"
14:13:24.339840 [debug] [MainThread]: On master: BEGIN
14:13:24.340036 [debug] [MainThread]: Opening a new connection, currently in state init
14:13:24.344703 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:13:24.344955 [debug] [MainThread]: Using postgres connection "master"
14:13:24.345101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:13:24.362398 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
14:13:24.363869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e3a30>]}
14:13:24.364183 [debug] [MainThread]: On master: ROLLBACK
14:13:24.364480 [debug] [MainThread]: Using postgres connection "master"
14:13:24.364628 [debug] [MainThread]: On master: BEGIN
14:13:24.364972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:13:24.365123 [debug] [MainThread]: On master: COMMIT
14:13:24.365255 [debug] [MainThread]: Using postgres connection "master"
14:13:24.365370 [debug] [MainThread]: On master: COMMIT
14:13:24.365614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:13:24.365773 [debug] [MainThread]: On master: Close
14:13:24.366135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:13:24.366373 [info ] [MainThread]: 
14:13:24.369352 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_accounts
14:13:24.369643 [info ] [Thread-1 (]: 1 of 6 START view model fleetio_analyst.stg_accounts ........................... [RUN]
14:13:24.370063 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.370206 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_accounts
14:13:24.370347 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_accounts
14:13:24.372574 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_accounts"
14:13:24.373062 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.373238 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_accounts
14:13:24.395074 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_accounts"
14:13:24.395687 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.395877 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: BEGIN
14:13:24.396008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.400684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:13:24.400922 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.401066 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."accounts"

)

select * from final
  );
14:13:24.403916 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:13:24.410473 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.410648 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:13:24.411209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.413059 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.413192 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:13:24.413685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.419691 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:13:24.419852 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.419982 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: COMMIT
14:13:24.420727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:13:24.425935 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_accounts"
14:13:24.426162 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_accounts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_accounts__dbt_backup" cascade
14:13:24.427410 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:13:24.428698 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.428874 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_accounts: Close
14:13:24.429255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc7aec0>]}
14:13:24.429603 [info ] [Thread-1 (]: 1 of 6 OK created view model fleetio_analyst.stg_accounts ...................... [[32mCREATE VIEW[0m in 0.06s]
14:13:24.430036 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_accounts
14:13:24.430251 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_contacts
14:13:24.430636 [info ] [Thread-1 (]: 2 of 6 START view model fleetio_analyst.stg_contacts ........................... [RUN]
14:13:24.431021 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.431171 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_contacts
14:13:24.431314 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_contacts
14:13:24.433588 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_contacts"
14:13:24.434062 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.434231 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_contacts
14:13:24.436270 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_contacts"
14:13:24.436708 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.436862 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: BEGIN
14:13:24.436988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.441647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:13:24.441880 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.442003 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */

  create view "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."contacts"

)

select * from final
  );
14:13:24.444257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:13:24.446603 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.446746 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts" rename to "stg_contacts__dbt_backup"
14:13:24.447277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.449129 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.449277 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
alter table "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_tmp" rename to "stg_contacts"
14:13:24.449652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.450694 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:13:24.450843 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.450961 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: COMMIT
14:13:24.451502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:13:24.452720 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_contacts"
14:13:24.452855 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_contacts"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_contacts__dbt_backup" cascade
14:13:24.454258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:13:24.456878 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.457069 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_contacts: Close
14:13:24.457441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e03550>]}
14:13:24.457774 [info ] [Thread-1 (]: 2 of 6 OK created view model fleetio_analyst.stg_contacts ...................... [[32mCREATE VIEW[0m in 0.03s]
14:13:24.458192 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_contacts
14:13:24.458398 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_leads
14:13:24.458710 [info ] [Thread-1 (]: 3 of 6 START view model fleetio_analyst.stg_leads .............................. [RUN]
14:13:24.459098 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.459236 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_leads
14:13:24.459366 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_leads
14:13:24.461690 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_leads"
14:13:24.462506 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.462751 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_leads
14:13:24.465564 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_leads"
14:13:24.466274 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.466472 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: BEGIN
14:13:24.466629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.471524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:13:24.471750 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.471901 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */

  create view "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."leads"

)

select * from final
  );
14:13:24.474922 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:13:24.477521 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.477687 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads" rename to "stg_leads__dbt_backup"
14:13:24.478209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.479962 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.480091 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
alter table "madisonflagg"."fleetio_analyst"."stg_leads__dbt_tmp" rename to "stg_leads"
14:13:24.480490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.481469 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:13:24.481599 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.481711 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: COMMIT
14:13:24.482227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:13:24.483508 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_leads"
14:13:24.483648 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_leads"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_leads__dbt_backup" cascade
14:13:24.484752 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:13:24.485710 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.485866 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_leads: Close
14:13:24.486250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058c850>]}
14:13:24.486562 [info ] [Thread-1 (]: 3 of 6 OK created view model fleetio_analyst.stg_leads ......................... [[32mCREATE VIEW[0m in 0.03s]
14:13:24.486976 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_leads
14:13:24.487181 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.stg_opportunities
14:13:24.487419 [info ] [Thread-1 (]: 4 of 6 START view model fleetio_analyst.stg_opportunities ...................... [RUN]
14:13:24.487868 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.488225 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.stg_opportunities
14:13:24.488383 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.stg_opportunities
14:13:24.490770 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.stg_opportunities"
14:13:24.491242 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.491409 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.stg_opportunities
14:13:24.493439 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.stg_opportunities"
14:13:24.493872 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.494029 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: BEGIN
14:13:24.494142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.498728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:13:24.498949 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.499068 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */

  create view "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" as (
    with final as (

    select
        *
    from "madisonflagg"."fleetio_analyst"."opportunities"

)

select * from final
  );
14:13:24.501615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
14:13:24.504071 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.504231 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities" rename to "stg_opportunities__dbt_backup"
14:13:24.504696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.506410 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.506556 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
alter table "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_tmp" rename to "stg_opportunities"
14:13:24.507009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.508087 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:13:24.508222 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.508349 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: COMMIT
14:13:24.508863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:13:24.510222 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.stg_opportunities"
14:13:24.510350 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.stg_opportunities"} */
drop view if exists "madisonflagg"."fleetio_analyst"."stg_opportunities__dbt_backup" cascade
14:13:24.511447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
14:13:24.512445 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.512614 [debug] [Thread-1 (]: On model.fleetio_analyst.stg_opportunities: Close
14:13:24.512982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de7070>]}
14:13:24.513311 [info ] [Thread-1 (]: 4 of 6 OK created view model fleetio_analyst.stg_opportunities ................. [[32mCREATE VIEW[0m in 0.03s]
14:13:24.513731 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.stg_opportunities
14:13:24.513930 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_conversion
14:13:24.514237 [info ] [Thread-1 (]: 5 of 6 START table model fleetio_analyst.lead_conversion ....................... [RUN]
14:13:24.514764 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.514922 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_conversion
14:13:24.515071 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_conversion
14:13:24.517361 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_conversion"
14:13:24.517827 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.518026 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_conversion
14:13:24.538954 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_conversion"
14:13:24.539625 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.539767 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: BEGIN
14:13:24.539884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.545446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
14:13:24.545685 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.545805 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp"
  as (
    select
    id as lead_id,
    source,
    converted_at::date as converted_at_day,
    date_trunc('week', converted_at)::date as converted_at_week,
    date_trunc('month', converted_at)::date as converted_at_month
from "madisonflagg"."fleetio_analyst"."stg_leads"
    where converted_at is not null
  );
14:13:24.551221 [debug] [Thread-1 (]: SQL status: SELECT 461 in 0.01 seconds
14:13:24.555056 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.555213 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion" rename to "lead_conversion__dbt_backup"
14:13:24.555634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.557504 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.557639 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
alter table "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_tmp" rename to "lead_conversion"
14:13:24.558095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
14:13:24.563414 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:13:24.563578 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.563696 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: COMMIT
14:13:24.564458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
14:13:24.566060 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_conversion"
14:13:24.566191 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_conversion"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_conversion__dbt_backup" cascade
14:13:24.568619 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
14:13:24.569988 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.570192 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_conversion: Close
14:13:24.570656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110576050>]}
14:13:24.571042 [info ] [Thread-1 (]: 5 of 6 OK created table model fleetio_analyst.lead_conversion .................. [[32mSELECT 461[0m in 0.06s]
14:13:24.571465 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_conversion
14:13:24.571665 [debug] [Thread-1 (]: Began running node model.fleetio_analyst.lead_drivers
14:13:24.572020 [info ] [Thread-1 (]: 6 of 6 START table model fleetio_analyst.lead_drivers .......................... [RUN]
14:13:24.572429 [debug] [Thread-1 (]: Acquiring new postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.572588 [debug] [Thread-1 (]: Began compiling node model.fleetio_analyst.lead_drivers
14:13:24.572736 [debug] [Thread-1 (]: Compiling model.fleetio_analyst.lead_drivers
14:13:24.575602 [debug] [Thread-1 (]: Writing injected SQL for node "model.fleetio_analyst.lead_drivers"
14:13:24.576066 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.576228 [debug] [Thread-1 (]: Began executing node model.fleetio_analyst.lead_drivers
14:13:24.578567 [debug] [Thread-1 (]: Writing runtime SQL for node "model.fleetio_analyst.lead_drivers"
14:13:24.579032 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.579213 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: BEGIN
14:13:24.579349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
14:13:24.584149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
14:13:24.584398 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.584520 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */


  create  table "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp"
  as (
    with lead_and_account_info as (

    select
        l.*,
        c.account_id as account_id
    from "madisonflagg"."fleetio_analyst"."stg_leads" l
    left join "madisonflagg"."fleetio_analyst"."stg_contacts" c
        on l.id = c.lead_id

)

select
    l.id as lead_id,
    case when converted_at is not null then true else false end as is_converted,
    o.is_closed,
    o.is_won,
    l.job_title,
    l.source,
    l.industry,
    l.fleet_size,
    l.state
from lead_and_account_info l
left join "madisonflagg"."fleetio_analyst"."stg_opportunities" o on l.account_id = o.account_id
  );
14:13:24.591442 [debug] [Thread-1 (]: SQL status: SELECT 946 in 0.01 seconds
14:13:24.593671 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.593827 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
alter table "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_tmp" rename to "lead_drivers"
14:13:24.599224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
14:13:24.603240 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
14:13:24.604940 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.605244 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: COMMIT
14:13:24.615353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
14:13:24.619811 [debug] [Thread-1 (]: Using postgres connection "model.fleetio_analyst.lead_drivers"
14:13:24.620183 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "fleetio_analyst", "target_name": "dev", "node_id": "model.fleetio_analyst.lead_drivers"} */
drop table if exists "madisonflagg"."fleetio_analyst"."lead_drivers__dbt_backup" cascade
14:13:24.620941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
14:13:24.623285 [debug] [Thread-1 (]: finished collecting timing info
14:13:24.623756 [debug] [Thread-1 (]: On model.fleetio_analyst.lead_drivers: Close
14:13:24.624699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817a4a6b-3546-4b8b-ac0d-2d1d91daf253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1bca0>]}
14:13:24.625446 [info ] [Thread-1 (]: 6 of 6 OK created table model fleetio_analyst.lead_drivers ..................... [[32mSELECT 946[0m in 0.05s]
14:13:24.626368 [debug] [Thread-1 (]: Finished running node model.fleetio_analyst.lead_drivers
14:13:24.628409 [debug] [MainThread]: Acquiring new postgres connection "master"
14:13:24.628730 [debug] [MainThread]: Using postgres connection "master"
14:13:24.629150 [debug] [MainThread]: On master: BEGIN
14:13:24.629417 [debug] [MainThread]: Opening a new connection, currently in state closed
14:13:24.635858 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:13:24.636147 [debug] [MainThread]: On master: COMMIT
14:13:24.636348 [debug] [MainThread]: Using postgres connection "master"
14:13:24.636605 [debug] [MainThread]: On master: COMMIT
14:13:24.637118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:13:24.637446 [debug] [MainThread]: On master: Close
14:13:24.638336 [info ] [MainThread]: 
14:13:24.638769 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.35s.
14:13:24.639223 [debug] [MainThread]: Connection 'master' was properly closed.
14:13:24.639516 [debug] [MainThread]: Connection 'model.fleetio_analyst.lead_drivers' was properly closed.
14:13:24.652768 [info ] [MainThread]: 
14:13:24.653035 [info ] [MainThread]: [32mCompleted successfully[0m
14:13:24.653410 [info ] [MainThread]: 
14:13:24.653633 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
14:13:24.654025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110577970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110576680>]}
